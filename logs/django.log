INFO 2025-09-21 15:15:05,945 autoreload 47596 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:42:43,681 autoreload 58928 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 15:42:52,726 log 58928 6193393664 Forbidden: /api/v1/health/
WARNING 2025-09-21 15:42:52,726 basehttp 58928 6193393664 "GET /api/v1/health/ HTTP/1.1" 403 63
WARNING 2025-09-21 15:42:58,986 log 58928 6193393664 Forbidden: /api/v1/collections/initiate/
WARNING 2025-09-21 15:42:58,987 basehttp 58928 6193393664 "POST /api/v1/collections/initiate/ HTTP/1.1" 403 63
WARNING 2025-09-21 15:43:11,355 log 58928 6193393664 Forbidden: /api/v1/health/
WARNING 2025-09-21 15:43:11,356 basehttp 58928 6193393664 "GET /api/v1/health/ HTTP/1.1" 403 63
WARNING 2025-09-21 15:43:33,916 log 58928 6193393664 Unauthorized: /api/v1/health/
WARNING 2025-09-21 15:43:33,916 basehttp 58928 6193393664 "GET /api/v1/health/ HTTP/1.1" 401 58
WARNING 2025-09-21 15:43:55,207 log 58928 6193393664 Forbidden: /api/v1/health/
WARNING 2025-09-21 15:43:55,207 basehttp 58928 6193393664 "GET /api/v1/health/ HTTP/1.1" 403 63
INFO 2025-09-21 15:44:02,909 autoreload 58928 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/authentication.py changed, reloading.
INFO 2025-09-21 15:44:03,300 autoreload 61495 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:44:08,779 autoreload 61495 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/authentication.py changed, reloading.
INFO 2025-09-21 15:44:09,253 autoreload 61595 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:44:11,696 autoreload 61595 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/authentication.py changed, reloading.
INFO 2025-09-21 15:44:11,990 autoreload 61601 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:44:19,423 autoreload 61601 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 15:44:19,739 autoreload 61699 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:44:23,092 autoreload 61699 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 15:44:23,383 autoreload 61707 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:44:43,058 autoreload 61707 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 15:44:43,414 autoreload 62027 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:45:24,118 basehttp 62027 6197063680 "GET /api/v1/health/ HTTP/1.1" 200 163
ERROR 2025-09-21 15:45:36,248 log 62027 6197063680 Internal Server Error: /api/v1/collections/initiate/
Traceback (most recent call last):
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/views/decorators/csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/decorators.py", line 19, in _wrapped
    ratelimited = is_ratelimited(request=request, group=group, fn=fn,
                                 key=key, rate=rate, method=method,
                                 increment=True)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 153, in is_ratelimited
    usage = get_usage(request, group, fn, key, rate, method, increment)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 169, in get_usage
    if not _method_match(request, method):
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 93, in _method_match
    return request.method in [m.upper() for m in method]
           ^^^^^^^^^^^^^^
AttributeError: 'CollectionInitiateView' object has no attribute 'method'
ERROR 2025-09-21 15:45:36,250 basehttp 62027 6197063680 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 109660
INFO 2025-09-21 15:45:44,219 basehttp 62027 6213890048 "GET /api/v1/collections/status/INV-001/ HTTP/1.1" 200 314
WARNING 2025-09-21 15:45:54,737 log 62027 6213890048 Not Found: /api/schema/swagger-ui/
WARNING 2025-09-21 15:45:54,737 basehttp 62027 6213890048 "GET /api/schema/swagger-ui/ HTTP/1.1" 404 2622
INFO 2025-09-21 15:45:59,925 basehttp 62027 6213890048 "GET /api/docs/ HTTP/1.1" 200 4478
INFO 2025-09-21 15:49:57,205 basehttp 62027 6213890048 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 15:49:57,209 basehttp 62027 6213890048 "GET /api/docs/ HTTP/1.1" 200 4478
ERROR 2025-09-21 15:49:57,223 log 62027 6213890048 Internal Server Error: /api/v1/collections/initiate/
Traceback (most recent call last):
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/views/decorators/csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/decorators.py", line 19, in _wrapped
    ratelimited = is_ratelimited(request=request, group=group, fn=fn,
                                 key=key, rate=rate, method=method,
                                 increment=True)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 153, in is_ratelimited
    usage = get_usage(request, group, fn, key, rate, method, increment)
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 169, in get_usage
    if not _method_match(request, method):
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django_ratelimit/core.py", line 93, in _method_match
    return request.method in [m.upper() for m in method]
           ^^^^^^^^^^^^^^
AttributeError: 'CollectionInitiateView' object has no attribute 'method'
ERROR 2025-09-21 15:49:57,224 basehttp 62027 6213890048 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 109950
ERROR 2025-09-21 15:49:57,562 views 62027 6230716416 Stripe webhook secret not configured
ERROR 2025-09-21 15:49:57,562 log 62027 6230716416 Internal Server Error: /api/v1/webhooks/stripe/
ERROR 2025-09-21 15:49:57,562 basehttp 62027 6230716416 "POST /api/v1/webhooks/stripe/ HTTP/1.1" 500 29
ERROR 2025-09-21 15:49:57,564 views 62027 6230716416 Error processing Salesforce webhook: Object of type LimitedStream is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py", line 100, in salesforce_webhook
    webhook_event = WebhookEvent.objects.create(
        source='salesforce',
    ...<4 lines>...
        status='received'
    )
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type LimitedStream is not JSON serializable
ERROR 2025-09-21 15:49:57,570 log 62027 6230716416 Internal Server Error: /api/v1/webhooks/notify-salesforce/
ERROR 2025-09-21 15:49:57,570 basehttp 62027 6230716416 "POST /api/v1/webhooks/notify-salesforce/ HTTP/1.1" 500 49
INFO 2025-09-21 15:50:17,281 autoreload 62027 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 15:50:17,766 autoreload 66659 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:50:48,934 autoreload 66659 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/models.py changed, reloading.
INFO 2025-09-21 15:50:49,312 autoreload 66953 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:50:50,726 autoreload 66953 8678638144 /Users/divyanshubhati/collections-agent-backend/payment_processing/models.py changed, reloading.
INFO 2025-09-21 15:50:51,016 autoreload 66960 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:50:52,354 autoreload 66960 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/models.py changed, reloading.
INFO 2025-09-21 15:50:52,612 autoreload 66966 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:50:54,979 autoreload 66966 8678638144 /Users/divyanshubhati/collections-agent-backend/payment_processing/admin.py changed, reloading.
INFO 2025-09-21 15:50:55,265 autoreload 67071 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:50:57,633 autoreload 67071 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/serializers.py changed, reloading.
INFO 2025-09-21 15:50:57,901 autoreload 67079 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:51:00,245 autoreload 67079 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 15:51:00,511 autoreload 67089 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:51:01,832 autoreload 67089 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/urls.py changed, reloading.
INFO 2025-09-21 15:51:02,082 autoreload 67093 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:51:04,437 autoreload 67093 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/urls.py changed, reloading.
INFO 2025-09-21 15:51:04,750 autoreload 67099 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:51:07,103 autoreload 67099 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/celery.py changed, reloading.
INFO 2025-09-21 15:51:07,379 autoreload 67197 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:52:38,813 autoreload 67197 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-21 15:52:39,257 autoreload 68063 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:52:43,744 autoreload 68063 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-21 15:52:44,102 autoreload 68068 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:52:48,482 autoreload 68068 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/__init__.py changed, reloading.
INFO 2025-09-21 15:52:48,785 autoreload 68165 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:58:47,433 autoreload 68165 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/tasks.py changed, reloading.
INFO 2025-09-21 15:58:47,825 autoreload 71483 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:11,642 autoreload 71483 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 15:59:11,938 autoreload 71911 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:24,539 autoreload 71911 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 15:59:24,984 autoreload 72224 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:31,511 autoreload 72224 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-21 15:59:31,814 autoreload 72238 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:33,334 autoreload 72238 8678638144 /Users/divyanshubhati/collections-agent-backend/collections_agent/__init__.py changed, reloading.
INFO 2025-09-21 15:59:33,639 autoreload 72337 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:34,982 autoreload 72337 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/tasks.py changed, reloading.
INFO 2025-09-21 15:59:35,223 autoreload 72341 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 15:59:36,582 autoreload 72341 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 15:59:36,987 autoreload 72348 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 16:00:07,841 autoreload 72348 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 16:00:08,240 autoreload 72643 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 16:00:11,773 autoreload 72643 8678638144 /Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 16:00:12,055 autoreload 72651 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 16:00:39,829 autoreload 72651 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 16:00:40,195 autoreload 73192 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 16:00:48,714 autoreload 73192 8678638144 /Users/divyanshubhati/collections-agent-backend/webhook_handlers/views.py changed, reloading.
INFO 2025-09-21 16:00:49,057 autoreload 73295 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 16:01:15,374 basehttp 73295 6131200000 "GET /api/v1/health/ HTTP/1.1" 200 163
WARNING 2025-09-21 16:01:23,687 log 73295 6131200000 Bad Request: /api/v1/collections/initiate/
WARNING 2025-09-21 16:01:23,687 basehttp 73295 6131200000 "POST /api/v1/collections/initiate/ HTTP/1.1" 400 226
ERROR 2025-09-21 16:01:30,608 views 73295 6148026368 Error processing collection request: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/collections-agent-backend/invoice_collections/views.py", line 115, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 16:01:30,613 log 73295 6148026368 Internal Server Error: /api/v1/collections/initiate/
ERROR 2025-09-21 16:01:30,613 basehttp 73295 6148026368 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 121
INFO 2025-09-21 16:01:41,524 basehttp 73295 6164852736 "GET /api/v1/collections/status/INV-001/ HTTP/1.1" 200 314
INFO 2025-09-21 16:03:55,960 basehttp 73295 6131200000 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 16:03:55,965 basehttp 73295 6131200000 "GET /api/v1/collections/status/INV-001/ HTTP/1.1" 200 314
INFO 2025-09-21 16:03:55,972 basehttp 73295 6131200000 "GET /api/docs/ HTTP/1.1" 200 4478
INFO 2025-09-21 16:03:55,982 basehttp 73295 6131200000 "GET /admin/ HTTP/1.1" 302 0
INFO 2025-09-21 16:03:55,993 basehttp 73295 6131200000 "GET /admin/login/?next=/admin/ HTTP/1.1" 200 4158
INFO 2025-09-21 18:02:41,464 autoreload 51346 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:10:18,177 autoreload 58175 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 18:10:28,956 log 58175 6169915392 Unauthorized: /api/v1/health/
WARNING 2025-09-21 18:10:28,957 basehttp 58175 6169915392 "GET /api/v1/health/ HTTP/1.1" 401 58
WARNING 2025-09-21 18:10:36,255 log 58175 6169915392 Unauthorized: /api/v1/health/
WARNING 2025-09-21 18:10:36,256 basehttp 58175 6169915392 "GET /api/v1/health/ HTTP/1.1" 401 28
WARNING 2025-09-21 18:10:49,086 log 58175 6169915392 Unauthorized: /api/v1/health/
WARNING 2025-09-21 18:10:49,087 basehttp 58175 6169915392 "GET /api/v1/health/ HTTP/1.1" 401 28
INFO 2025-09-21 18:11:01,904 autoreload 59472 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 18:11:09,713 log 59472 6158872576 Unauthorized: /api/v1/health/
WARNING 2025-09-21 18:11:09,713 basehttp 59472 6158872576 "GET /api/v1/health/ HTTP/1.1" 401 28
INFO 2025-09-21 18:12:01,492 autoreload 60615 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:12:13,836 basehttp 60615 6134493184 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 18:13:36,022 basehttp 60615 6134493184 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 663
INFO 2025-09-21 18:13:36,026 basehttp 60615 6134493184 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 565
INFO 2025-09-21 18:13:36,030 basehttp 60615 6134493184 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:13:47,428 basehttp 60615 6134493184 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:14:01,172 basehttp 60615 6134493184 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 663
INFO 2025-09-21 18:14:01,176 basehttp 60615 6134493184 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 917
INFO 2025-09-21 18:14:01,180 basehttp 60615 6134493184 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
WARNING 2025-09-21 18:14:01,181 views 60615 6134493184 Invalid A2A signature
WARNING 2025-09-21 18:14:01,181 log 60615 6134493184 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 18:14:01,181 basehttp 60615 6134493184 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
WARNING 2025-09-21 18:14:14,922 views 60615 6134493184 Invalid A2A signature
WARNING 2025-09-21 18:14:14,922 log 60615 6134493184 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 18:14:14,922 basehttp 60615 6134493184 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
INFO 2025-09-21 18:14:44,610 autoreload 60615 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/models.py changed, reloading.
INFO 2025-09-21 18:14:45,029 autoreload 63951 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:14:54,871 autoreload 63951 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/payment_processing/urls.py changed, reloading.
INFO 2025-09-21 18:14:55,290 autoreload 64059 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:14:56,919 autoreload 64059 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/payment_processing/models.py changed, reloading.
INFO 2025-09-21 18:14:57,215 autoreload 64063 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:14:58,756 autoreload 64063 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/models.py changed, reloading.
INFO 2025-09-21 18:14:59,049 autoreload 64158 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:29:03,020 basehttp 64158 6126678016 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 18:29:15,799 basehttp 64158 6126678016 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 663
INFO 2025-09-21 18:29:21,835 basehttp 64158 6126678016 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:39:00,756 basehttp 64158 6126678016 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 18:39:07,864 basehttp 64158 6126678016 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 663
INFO 2025-09-21 18:39:17,234 basehttp 64158 6126678016 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1269
INFO 2025-09-21 18:39:21,758 basehttp 64158 6126678016 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:39:27,726 views 64158 6126678016 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'external_invoice_id': 'SF-INV-003', 'amount_cents': 750000, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce_agent'}
WARNING 2025-09-21 18:39:27,731 log 64158 6126678016 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:39:27,733 basehttp 64158 6126678016 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 274
INFO 2025-09-21 18:39:36,685 views 64158 6126678016 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'external_invoice_id': 'SF-INV-003', 'amount_cents': 750000, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce_agent'}
WARNING 2025-09-21 18:39:36,686 log 64158 6126678016 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:39:36,687 basehttp 64158 6126678016 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 274
WARNING 2025-09-21 18:39:48,924 log 64158 6126678016 Bad Request: /api/v1/integration/webhook/status-update/
WARNING 2025-09-21 18:39:48,925 basehttp 64158 6126678016 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 400 102
WARNING 2025-09-21 18:40:12,092 log 64158 6126678016 Bad Request: /api/v1/collections/initiate/
WARNING 2025-09-21 18:40:12,094 basehttp 64158 6126678016 "POST /api/v1/collections/initiate/ HTTP/1.1" 400 274
ERROR 2025-09-21 18:40:22,350 views 64158 6126678016 Error getting collection status: Cannot resolve keyword 'sf_invoice_id' into field. Choices are: agent_actions, amount_cents, ap2paymentrequest, approved_by, collection_request, created_at, currency, customer_id, customer_name, due_date, external_invoice_id, id, idempotency_key, invoice_id, mandate_id, metadata, payment_attempts, payment_method, payments, salesforce_notifications, status, updated_at
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 160, in get
    invoice = Invoice.objects.filter(
              ~~~~~~~~~~~~~~~~~~~~~~^
        models.Q(invoice_id=invoice_id) | models.Q(sf_invoice_id=invoice_id)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).first()
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1461, in build_filter
    return self._add_q(
           ~~~~~~~~~~~^
        filter_expr,
        ^^^^^^^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1484, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1296, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1761, in names_to_path
    raise FieldError(
    ...<2 lines>...
    )
django.core.exceptions.FieldError: Cannot resolve keyword 'sf_invoice_id' into field. Choices are: agent_actions, amount_cents, ap2paymentrequest, approved_by, collection_request, created_at, currency, customer_id, customer_name, due_date, external_invoice_id, id, idempotency_key, invoice_id, mandate_id, metadata, payment_attempts, payment_method, payments, salesforce_notifications, status, updated_at
ERROR 2025-09-21 18:40:22,358 log 64158 6126678016 Internal Server Error: /api/v1/collections/status/INV-2024-002/
ERROR 2025-09-21 18:40:22,358 basehttp 64158 6126678016 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 500 116
WARNING 2025-09-21 18:40:33,302 views 64158 6126678016 Invalid A2A signature
WARNING 2025-09-21 18:40:33,303 log 64158 6126678016 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 18:40:33,303 basehttp 64158 6126678016 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
WARNING 2025-09-21 18:40:39,137 views 64158 6126678016 Invalid A2A signature
WARNING 2025-09-21 18:40:39,138 log 64158 6126678016 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 18:40:39,139 basehttp 64158 6126678016 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 18:40:43,554 views 64158 6126678016 Invalid A2A signature
WARNING 2025-09-21 18:40:43,555 log 64158 6126678016 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 18:40:43,555 basehttp 64158 6126678016 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 18:40:59,704 log 64158 6126678016 Not Found: /api/v1/payment-processing/payment-methods/
WARNING 2025-09-21 18:40:59,705 basehttp 64158 6126678016 "POST /api/v1/payment-processing/payment-methods/ HTTP/1.1" 404 4200
WARNING 2025-09-21 18:41:07,914 log 64158 6126678016 Not Found: /api/v1/payment-processing/payment-methods/
WARNING 2025-09-21 18:41:07,915 basehttp 64158 6126678016 "GET /api/v1/payment-processing/payment-methods/ HTTP/1.1" 404 4199
WARNING 2025-09-21 18:41:13,586 log 64158 6126678016 Not Found: /api/v1/payment-processing/payments/
WARNING 2025-09-21 18:41:13,586 basehttp 64158 6126678016 "POST /api/v1/payment-processing/payments/ HTTP/1.1" 404 4179
WARNING 2025-09-21 18:41:17,887 log 64158 6126678016 Not Found: /api/v1/payment-processing/payments/
WARNING 2025-09-21 18:41:17,888 basehttp 64158 6126678016 "GET /api/v1/payment-processing/payments/ HTTP/1.1" 404 4178
INFO 2025-09-21 18:41:35,184 basehttp 64158 6126678016 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1235
INFO 2025-09-21 18:41:45,234 basehttp 64158 6126678016 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 663
INFO 2025-09-21 18:41:49,230 basehttp 64158 6126678016 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:42:31,437 basehttp 64158 6126678016 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 18:43:05,149 autoreload 81325 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:43:41,320 autoreload 81978 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 18:46:11,867 log 81978 6126972928 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:46:11,868 basehttp 81978 6126972928 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 28
WARNING 2025-09-21 18:46:21,019 log 81978 6126972928 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:46:21,019 basehttp 81978 6126972928 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 28
WARNING 2025-09-21 18:46:22,018 log 81978 6126972928 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:46:22,019 basehttp 81978 6126972928 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 28
WARNING 2025-09-21 18:49:43,690 log 81978 6143799296 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:49:43,690 basehttp 81978 6143799296 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 28
WARNING 2025-09-21 18:49:46,589 log 81978 6143799296 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:49:46,589 basehttp 81978 6143799296 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 28
INFO 2025-09-21 18:50:12,056 autoreload 86422 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:50:15,014 views 86422 6163902464 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'external_invoice_id': 'SF-INV-003', 'amount_cents': 750000, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce_agent'}
WARNING 2025-09-21 18:50:15,016 log 86422 6163902464 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:50:15,016 basehttp 86422 6163902464 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 274
INFO 2025-09-21 18:52:54,558 views 86422 12901707776 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 18:52:54,568 views 86422 12901707776 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 18:52:54,576 log 86422 12901707776 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:52:54,576 basehttp 86422 12901707776 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 18:53:19,652 views 86422 12918534144 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': '7500.00', 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 18:53:19,653 views 86422 12918534144 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 18:53:19,654 log 86422 12918534144 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:53:19,654 basehttp 86422 12918534144 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 18:53:50,202 views 86422 12935360512 Salesforce webhook received: {'invoice_id': 'INV-2024-005', 'sf_invoice_id': 'SF-INV-005', 'amount': '8500.00', 'currency': 'USD', 'customer_id': 'CUST-005', 'customer_name': 'Test Company', 'mandate_id': 'MANDATE-005', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'test@company.com', 'idempotency_key': 'SF-INV-005-2024-09-21-UNIQUE'}
ERROR 2025-09-21 18:53:50,205 views 86422 12935360512 Error processing Salesforce webhook: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 113, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated from Salesforce for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 18:53:50,210 log 86422 12935360512 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:53:50,210 basehttp 86422 12935360512 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
ERROR 2025-09-21 18:54:51,334 views 86422 12901707776 Error processing collection request: Invoice() got unexpected keyword arguments: 'sf_invoice_id'
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 675, in create
    obj = self.model(**kwargs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
    ...<2 lines>...
    )
TypeError: Invoice() got unexpected keyword arguments: 'sf_invoice_id'
ERROR 2025-09-21 18:54:51,338 log 86422 12901707776 Internal Server Error: /api/v1/collections/initiate/
ERROR 2025-09-21 18:54:51,339 basehttp 86422 12901707776 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 121
INFO 2025-09-21 18:54:56,782 basehttp 86422 12901707776 "GET /api/v1/health/ HTTP/1.1" 200 163
INFO 2025-09-21 18:55:21,662 views 86422 12901707776 Salesforce webhook received: {'invoice_id': 'INV-2024-007', 'sf_invoice_id': 'SF-INV-007', 'amount': '10500.00', 'currency': 'USD', 'customer_id': 'CUST-007', 'customer_name': 'Test Company 3', 'mandate_id': 'MANDATE-007', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'test3@company.com', 'idempotency_key': 'SF-INV-007-2024-09-21-NEW'}
ERROR 2025-09-21 18:55:21,664 views 86422 12901707776 Error processing Salesforce webhook: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 113, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated from Salesforce for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 18:55:21,665 log 86422 12901707776 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:55:21,665 basehttp 86422 12901707776 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 18:55:56,633 views 86422 12918534144 Salesforce webhook received: {'invoice_id': 'INV-2024-009', 'sf_invoice_id': 'SF-INV-009', 'amount': '12500.00', 'currency': 'USD', 'customer_id': 'CUST-009', 'customer_name': 'Test Company 5', 'mandate_id': 'MANDATE-009', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'test5@company.com', 'idempotency_key': 'SF-INV-009-2024-09-21-NEW'}
ERROR 2025-09-21 18:55:56,636 views 86422 12918534144 Error processing Salesforce webhook: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 113, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated from Salesforce for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 18:55:56,638 log 86422 12918534144 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:55:56,638 basehttp 86422 12918534144 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 18:56:08,666 autoreload 86422 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 18:56:09,139 autoreload 96627 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 18:56:16,157 log 96627 6170537984 Unauthorized: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-21 18:56:16,157 basehttp 96627 6170537984 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 401 58
INFO 2025-09-21 18:57:03,821 autoreload 96627 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 18:57:04,243 autoreload 97655 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 18:58:00,509 basehttp 97655 6166589440 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 970
INFO 2025-09-21 18:58:07,584 basehttp 97655 6166589440 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1235
INFO 2025-09-21 18:58:13,013 basehttp 97655 6166589440 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 18:58:17,923 views 97655 6166589440 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 18:58:17,930 views 97655 6166589440 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 18:58:17,938 log 97655 6166589440 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:58:17,938 basehttp 97655 6166589440 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
WARNING 2025-09-21 18:58:23,637 log 97655 6166589440 Bad Request: /api/v1/integration/webhook/status-update/
WARNING 2025-09-21 18:58:23,637 basehttp 97655 6166589440 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 400 102
INFO 2025-09-21 18:59:26,473 views 97655 6183415808 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 18:59:26,493 views 97655 6183415808 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 18:59:26,498 log 97655 6183415808 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 18:59:26,498 basehttp 97655 6183415808 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 19:00:12,897 autoreload 99802 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:00:23,361 views 99802 6194081792 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 19:00:23,366 views 99802 6194081792 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 19:00:23,372 log 99802 6194081792 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 19:00:23,372 basehttp 99802 6194081792 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-21 19:00:32,004 autoreload 99802 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:00:32,435 autoreload 849 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:00:37,541 views 849 6159740928 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 19:00:37,543 views 849 6159740928 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 19:00:37,547 log 849 6159740928 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 19:00:37,547 basehttp 849 6159740928 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 169
INFO 2025-09-21 19:00:50,298 views 849 6159740928 Salesforce webhook received: {'invoice_id': 'INV-2024-999', 'sf_invoice_id': 'SF-INV-999', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-999', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-999', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-999-2024-09-21'}
ERROR 2025-09-21 19:00:50,303 views 849 6159740928 Error processing Salesforce webhook: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 113, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated from Salesforce for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 19:00:50,306 log 849 6159740928 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 19:00:50,306 basehttp 849 6159740928 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 166
INFO 2025-09-21 19:00:56,546 autoreload 849 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:00:57,037 autoreload 2449 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:02,889 views 2449 6169423872 Salesforce webhook received: {'invoice_id': 'INV-2024-888', 'sf_invoice_id': 'SF-INV-888', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-888', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-888', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-888-2024-09-21'}
ERROR 2025-09-21 19:01:02,892 views 2449 6169423872 Error processing Salesforce webhook: Object of type datetime is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 118, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated from Salesforce for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type datetime is not JSON serializable
ERROR 2025-09-21 19:01:02,896 log 2449 6169423872 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 19:01:02,896 basehttp 2449 6169423872 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 167
INFO 2025-09-21 19:01:03,815 autoreload 2449 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:04,233 autoreload 3112 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:05,833 autoreload 3112 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:06,122 autoreload 3113 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:08,689 autoreload 3113 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:09,074 autoreload 3121 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:10,594 autoreload 3121 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:11,014 autoreload 3216 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:13,516 views 3216 6124367872 Salesforce webhook received: {'invoice_id': 'INV-2024-777', 'sf_invoice_id': 'SF-INV-777', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-21 19:01:13,519 basehttp 3216 6124367872 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 202 174
INFO 2025-09-21 19:01:18,531 views 3216 6124367872 Salesforce webhook received: {'invoice_id': 'INV-2024-003', 'sf_invoice_id': 'SF-INV-003', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-003', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-003', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-003-2024-09-21'}
ERROR 2025-09-21 19:01:18,536 views 3216 6124367872 Error processing Salesforce webhook: UNIQUE constraint failed: invoices.invoice_id
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: invoices.invoice_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 93, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: UNIQUE constraint failed: invoices.invoice_id
ERROR 2025-09-21 19:01:18,541 log 3216 6124367872 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-21 19:01:18,541 basehttp 3216 6124367872 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 169
INFO 2025-09-21 19:01:19,697 autoreload 3216 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:20,015 autoreload 3796 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:22,599 autoreload 3796 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:23,001 autoreload 3895 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:01:42,937 views 3895 6138032128 Salesforce webhook received: {'invoice_id': 'INV-2024-555', 'sf_invoice_id': 'SF-INV-555', 'amount': 8500.0, 'currency': 'USD', 'customer_id': 'CUST-555', 'customer_name': 'Test Company', 'mandate_id': 'MANDATE-555', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'test@company.com', 'idempotency_key': 'SF-INV-555-2024-09-21'}
INFO 2025-09-21 19:01:42,942 basehttp 3895 6138032128 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 202 174
INFO 2025-09-21 19:01:57,237 autoreload 3895 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-21 19:01:57,646 autoreload 4757 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:02:21,760 basehttp 4757 6127300608 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 1554
INFO 2025-09-21 19:02:25,340 basehttp 4757 6127300608 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1235
INFO 2025-09-21 19:02:28,478 basehttp 4757 6127300608 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 19:02:31,959 views 4757 6127300608 Salesforce webhook received: {'invoice_id': 'INV-2024-777', 'sf_invoice_id': 'SF-INV-777', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-21 19:02:31,966 basehttp 4757 6127300608 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 168
WARNING 2025-09-21 19:02:38,367 log 4757 6127300608 Bad Request: /api/v1/integration/webhook/status-update/
WARNING 2025-09-21 19:02:38,367 basehttp 4757 6127300608 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 400 102
ERROR 2025-09-21 19:02:55,930 views 4757 6127300608 Error processing collection request: Invoice() got unexpected keyword arguments: 'sf_invoice_id'
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 675, in create
    obj = self.model(**kwargs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
    ...<2 lines>...
    )
TypeError: Invoice() got unexpected keyword arguments: 'sf_invoice_id'
ERROR 2025-09-21 19:02:55,934 log 4757 6127300608 Internal Server Error: /api/v1/collections/initiate/
ERROR 2025-09-21 19:02:55,935 basehttp 4757 6127300608 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 121
ERROR 2025-09-21 19:03:00,590 views 4757 6127300608 Error getting collection status: Cannot resolve keyword 'sf_invoice_id' into field. Choices are: agent_actions, amount_cents, ap2paymentrequest, approved_by, collection_request, created_at, currency, customer_id, customer_name, due_date, external_invoice_id, id, idempotency_key, invoice_id, mandate_id, metadata, payment_attempts, payment_method, payments, salesforce_notifications, status, updated_at
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 160, in get
    invoice = Invoice.objects.filter(
              ~~~~~~~~~~~~~~~~~~~~~~^
        models.Q(invoice_id=invoice_id) | models.Q(sf_invoice_id=invoice_id)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).first()
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1461, in build_filter
    return self._add_q(
           ~~~~~~~~~~~^
        filter_expr,
        ^^^^^^^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1484, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1296, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1761, in names_to_path
    raise FieldError(
    ...<2 lines>...
    )
django.core.exceptions.FieldError: Cannot resolve keyword 'sf_invoice_id' into field. Choices are: agent_actions, amount_cents, ap2paymentrequest, approved_by, collection_request, created_at, currency, customer_id, customer_name, due_date, external_invoice_id, id, idempotency_key, invoice_id, mandate_id, metadata, payment_attempts, payment_method, payments, salesforce_notifications, status, updated_at
ERROR 2025-09-21 19:03:00,596 log 4757 6127300608 Internal Server Error: /api/v1/collections/status/INV-2024-002/
ERROR 2025-09-21 19:03:00,596 basehttp 4757 6127300608 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 500 116
WARNING 2025-09-21 19:03:05,605 views 4757 6127300608 Invalid A2A signature
WARNING 2025-09-21 19:03:05,606 log 4757 6127300608 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 19:03:05,606 basehttp 4757 6127300608 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:03:09,337 views 4757 6127300608 Invalid A2A signature
WARNING 2025-09-21 19:03:09,337 log 4757 6127300608 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:03:09,338 basehttp 4757 6127300608 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:03:12,514 views 4757 6127300608 Invalid A2A signature
WARNING 2025-09-21 19:03:12,515 log 4757 6127300608 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 19:03:12,516 basehttp 4757 6127300608 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:03:18,299 log 4757 6127300608 Not Found: /api/v1/payment-processing/payment-methods/
WARNING 2025-09-21 19:03:18,299 basehttp 4757 6127300608 "POST /api/v1/payment-processing/payment-methods/ HTTP/1.1" 404 4200
INFO 2025-09-21 19:05:05,892 autoreload 4757 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:05:06,376 autoreload 6693 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:05:13,129 autoreload 6693 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:05:13,599 autoreload 6707 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:05:39,696 basehttp 6707 6170570752 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 143
ERROR 2025-09-21 19:05:45,655 views 6707 6170570752 Error processing collection request: Object of type Decimal is not JSON serializable
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 115, in post
    AgentAction.objects.create(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        invoice=invoice,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        notes=f'Collection initiated for invoice {invoice.invoice_id}'
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1747, in as_sql
    self.prepare_value(field, self.pre_save_val(field, obj))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1686, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 136, in get_db_prep_save
    return self.get_db_prep_value(value, connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/json.py", line 131, in get_db_prep_value
    return connection.ops.adapt_json_value(value, self.encoder)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/base/operations.py", line 594, in adapt_json_value
    return json.dumps(value, cls=encoder)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type Decimal is not JSON serializable
ERROR 2025-09-21 19:05:45,659 log 6707 6170570752 Internal Server Error: /api/v1/collections/initiate/
ERROR 2025-09-21 19:05:45,660 basehttp 6707 6170570752 "POST /api/v1/collections/initiate/ HTTP/1.1" 500 121
INFO 2025-09-21 19:05:49,998 autoreload 6707 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:05:50,388 autoreload 8266 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:05:55,086 autoreload 8266 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:05:55,417 autoreload 8367 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:05:56,918 autoreload 8367 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:05:57,286 autoreload 8371 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:06:07,276 basehttp 8371 6132084736 "POST /api/v1/collections/initiate/ HTTP/1.1" 202 151
ERROR 2025-09-21 19:06:15,302 views 8371 6132084736 Error getting collection status: 'Invoice' object has no attribute 'sf_invoice_id'
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py", line 186, in get
    'sf_invoice_id': invoice.sf_invoice_id,
                     ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Invoice' object has no attribute 'sf_invoice_id'. Did you mean: 'invoice_id'?
ERROR 2025-09-21 19:06:15,303 log 8371 6132084736 Internal Server Error: /api/v1/collections/status/INV-2024-002/
ERROR 2025-09-21 19:06:15,303 basehttp 8371 6132084736 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 500 116
INFO 2025-09-21 19:06:25,473 autoreload 8371 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:06:25,913 autoreload 9416 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:06:45,067 basehttp 9416 6168457216 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 200 315
INFO 2025-09-21 19:07:23,765 autoreload 9416 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:07:24,131 autoreload 10112 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:07:48,446 autoreload 10112 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/invoice_collections/views.py changed, reloading.
INFO 2025-09-21 19:07:48,926 autoreload 10401 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:09:34,545 basehttp 10401 6161772544 "POST /api/v1/collections/initiate/ HTTP/1.1" 202 151
INFO 2025-09-21 19:09:40,906 basehttp 10401 6161772544 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 143
INFO 2025-09-21 19:12:11,757 basehttp 10401 6161772544 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-21 19:12:15,190 views 10401 6161772544 Salesforce webhook received: {'invoice_id': 'INV-2024-777', 'sf_invoice_id': 'SF-INV-777', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-21 19:12:15,195 basehttp 10401 6161772544 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 168
INFO 2025-09-21 19:12:19,571 basehttp 10401 6161772544 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 142
INFO 2025-09-21 19:12:24,656 basehttp 10401 6161772544 "POST /api/v1/collections/initiate/ HTTP/1.1" 200 179
INFO 2025-09-21 19:12:30,947 basehttp 10401 6161772544 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 200 315
WARNING 2025-09-21 19:13:12,265 views 10401 6161772544 Invalid A2A signature
WARNING 2025-09-21 19:13:12,266 log 10401 6161772544 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 19:13:12,267 basehttp 10401 6161772544 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
INFO 2025-09-21 19:13:16,374 basehttp 10401 6161772544 "GET /api/v1/collections/status/INV-2024-002/ HTTP/1.1" 200 315
WARNING 2025-09-21 19:13:21,244 views 10401 6161772544 Invalid A2A signature
WARNING 2025-09-21 19:13:21,245 log 10401 6161772544 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:13:21,245 basehttp 10401 6161772544 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:13:26,558 views 10401 6161772544 Invalid A2A signature
WARNING 2025-09-21 19:13:26,559 log 10401 6161772544 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 19:13:26,559 basehttp 10401 6161772544 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:13:31,540 log 10401 6161772544 Not Found: /api/v1/payment-processing/payment-methods/
WARNING 2025-09-21 19:13:31,540 basehttp 10401 6161772544 "POST /api/v1/payment-processing/payment-methods/ HTTP/1.1" 404 4200
INFO 2025-09-21 19:15:49,268 autoreload 16169 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 19:16:07,554 views 16169 6197014528 Invalid A2A signature
WARNING 2025-09-21 19:16:07,556 log 16169 6197014528 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 19:16:07,556 basehttp 16169 6197014528 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:17:35,414 views 16169 6213840896 Invalid A2A signature
WARNING 2025-09-21 19:17:35,417 log 16169 6213840896 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:17:35,417 basehttp 16169 6213840896 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
INFO 2025-09-21 19:19:33,320 autoreload 16169 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:19:33,802 autoreload 18277 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:19:39,524 autoreload 18277 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:19:39,912 autoreload 18378 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:19:48,701 views 18378 6193442816 A2A agent registered: test_collections_agent (178ca891-1a09-4718-856e-92d8c1c38ddc)
INFO 2025-09-21 19:19:48,701 basehttp 18378 6193442816 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 201 155
ERROR 2025-09-21 19:19:57,870 views 18378 6193442816 Error initiating A2A conversation: ['“salesforce_collections_agent” is not a valid UUID.']
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2747, in to_python
    return uuid.UUID(**{input_form: value})
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/uuid.py", line 181, in __init__
    raise ValueError('badly formed hexadecimal UUID string')
ValueError: badly formed hexadecimal UUID string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py", line 59, in a2a_conversation_initiate
    initiator_agent = A2AAgent.objects.get(agent_id=data['initiator_agent_id'])
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 633, in get
    clone = self._chain() if self.query.combinator else self.filter(*args, **kwargs)
                                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1548, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1378, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 30, in __init__
    self.rhs = self.get_prep_lookup()
               ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 362, in get_prep_lookup
    return super().get_prep_lookup()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 88, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2731, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2749, in to_python
    raise exceptions.ValidationError(
    ...<3 lines>...
    )
django.core.exceptions.ValidationError: ['“salesforce_collections_agent” is not a valid UUID.']
ERROR 2025-09-21 19:19:57,875 log 18378 6193442816 Internal Server Error: /api/v1/a2a/conversations/initiate/
ERROR 2025-09-21 19:19:57,875 basehttp 18378 6193442816 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 500 63
WARNING 2025-09-21 19:20:04,346 views 18378 6210269184 Invalid A2A signature
WARNING 2025-09-21 19:20:04,346 log 18378 6210269184 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:20:04,347 basehttp 18378 6210269184 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
INFO 2025-09-21 19:20:18,389 autoreload 18378 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:20:18,895 autoreload 19890 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:21:22,064 basehttp 19890 6205206528 "GET /api/v1/a2a/agents/ HTTP/1.1" 200 1279
INFO 2025-09-21 19:21:51,826 autoreload 19890 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:21:52,247 autoreload 20918 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:22:35,189 autoreload 20918 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:22:35,642 autoreload 21300 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:26:50,242 autoreload 21300 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:26:50,687 autoreload 23685 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:26:54,380 autoreload 23685 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:26:54,857 autoreload 23782 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:26:57,378 autoreload 23782 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:26:57,742 autoreload 23788 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:27:02,311 autoreload 23788 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:27:02,588 autoreload 23794 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:27:07,117 autoreload 23794 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:27:07,453 autoreload 23890 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 19:27:19,452 views 23890 6159429632 Invalid A2A signature
WARNING 2025-09-21 19:27:19,453 log 23890 6159429632 Unauthorized: /api/v1/a2a/agents/register/
WARNING 2025-09-21 19:27:19,453 basehttp 23890 6159429632 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:27:19,455 views 23890 6176256000 Invalid A2A signature
WARNING 2025-09-21 19:27:19,455 log 23890 6176256000 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 19:27:19,455 basehttp 23890 6176256000 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:27:19,456 views 23890 6193082368 Invalid A2A signature
WARNING 2025-09-21 19:27:19,456 log 23890 6193082368 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:27:19,456 basehttp 23890 6193082368 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
INFO 2025-09-21 19:27:43,581 views 23890 6159429632 A2A agent registered: test_collections_agent_3 (8bb8ca36-0ba6-4134-86f3-9aeceafe9f20)
INFO 2025-09-21 19:27:43,582 basehttp 23890 6159429632 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 201 157
ERROR 2025-09-21 19:27:43,589 views 23890 6159429632 Error initiating A2A conversation: ['“salesforce_collections_agent” is not a valid UUID.']
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2747, in to_python
    return uuid.UUID(**{input_form: value})
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/uuid.py", line 181, in __init__
    raise ValueError('badly formed hexadecimal UUID string')
ValueError: badly formed hexadecimal UUID string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py", line 59, in a2a_conversation_initiate
    initiator_agent = A2AAgent.objects.get(agent_id=data['initiator_agent_id'])
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 633, in get
    clone = self._chain() if self.query.combinator else self.filter(*args, **kwargs)
                                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1548, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1378, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 30, in __init__
    self.rhs = self.get_prep_lookup()
               ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 362, in get_prep_lookup
    return super().get_prep_lookup()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 88, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2731, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2749, in to_python
    raise exceptions.ValidationError(
    ...<3 lines>...
    )
django.core.exceptions.ValidationError: ['“salesforce_collections_agent” is not a valid UUID.']
ERROR 2025-09-21 19:27:43,597 log 23890 6159429632 Internal Server Error: /api/v1/a2a/conversations/initiate/
ERROR 2025-09-21 19:27:43,598 basehttp 23890 6159429632 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 500 63
INFO 2025-09-21 19:27:43,602 basehttp 23890 6176256000 "GET /api/v1/a2a/agents/ HTTP/1.1" 200 1609
INFO 2025-09-21 19:28:32,765 autoreload 23890 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:28:33,215 autoreload 25141 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:46:39,503 autoreload 25141 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:46:39,934 autoreload 35537 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:47:23,704 autoreload 35537 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:47:24,144 autoreload 35919 8678638144 Watching for file changes with StatReloader
INFO 2025-09-21 19:52:30,390 autoreload 35919 8678638144 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-21 19:52:30,844 autoreload 38870 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 19:52:42,651 log 38870 6190985216 Bad Request: /api/v1/a2a/agents/register/
WARNING 2025-09-21 19:52:42,652 basehttp 38870 6190985216 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 400 75
WARNING 2025-09-21 19:52:48,038 views 38870 6190985216 Invalid A2A signature
WARNING 2025-09-21 19:52:48,039 log 38870 6190985216 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:52:48,039 basehttp 38870 6190985216 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:53:05,377 views 38870 6190985216 Invalid A2A signature
WARNING 2025-09-21 19:53:05,379 log 38870 6190985216 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:53:05,379 basehttp 38870 6190985216 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 19:55:31,722 views 38870 6207811584 Invalid A2A signature
WARNING 2025-09-21 19:55:31,723 log 38870 6207811584 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 19:55:31,723 basehttp 38870 6207811584 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:01:33,918 log 38870 6207811584 Bad Request: /api/v1/a2a/agents/register/
WARNING 2025-09-21 20:01:33,919 basehttp 38870 6207811584 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 400 75
ERROR 2025-09-21 20:01:33,922 views 38870 6207811584 Error initiating A2A conversation: ['“salesforce_collections_agent” is not a valid UUID.']
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2747, in to_python
    return uuid.UUID(**{input_form: value})
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/uuid.py", line 181, in __init__
    raise ValueError('badly formed hexadecimal UUID string')
ValueError: badly formed hexadecimal UUID string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py", line 59, in a2a_conversation_initiate
    initiator_agent = A2AAgent.objects.get(agent_id=data['initiator_agent_id'])
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 633, in get
    clone = self._chain() if self.query.combinator else self.filter(*args, **kwargs)
                                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1548, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1378, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 30, in __init__
    self.rhs = self.get_prep_lookup()
               ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 362, in get_prep_lookup
    return super().get_prep_lookup()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 88, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2731, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2749, in to_python
    raise exceptions.ValidationError(
    ...<3 lines>...
    )
django.core.exceptions.ValidationError: ['“salesforce_collections_agent” is not a valid UUID.']
ERROR 2025-09-21 20:01:33,929 log 38870 6207811584 Internal Server Error: /api/v1/a2a/conversations/initiate/
ERROR 2025-09-21 20:01:33,929 basehttp 38870 6207811584 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 500 63
INFO 2025-09-21 20:01:33,932 basehttp 38870 6224637952 "GET /api/v1/a2a/agents/ HTTP/1.1" 200 1609
WARNING 2025-09-21 20:01:45,212 views 38870 6224637952 Invalid A2A signature
WARNING 2025-09-21 20:01:45,213 log 38870 6224637952 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:01:45,213 basehttp 38870 6224637952 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:01:46,026 views 38870 6224637952 Invalid A2A signature
WARNING 2025-09-21 20:01:46,026 log 38870 6224637952 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:01:46,027 basehttp 38870 6224637952 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
INFO 2025-09-21 20:02:02,244 autoreload 45076 8678638144 Watching for file changes with StatReloader
WARNING 2025-09-21 20:02:04,574 views 45076 6195752960 Invalid A2A signature
WARNING 2025-09-21 20:02:04,575 log 45076 6195752960 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:02:04,576 basehttp 45076 6195752960 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:06:09,971 log 45076 6212579328 Bad Request: /api/v1/a2a/agents/register/
WARNING 2025-09-21 20:06:09,972 basehttp 45076 6212579328 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 400 75
ERROR 2025-09-21 20:06:09,975 views 45076 6212579328 Error initiating A2A conversation: ['“salesforce_collections_agent” is not a valid UUID.']
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2747, in to_python
    return uuid.UUID(**{input_form: value})
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/lib/python3.13/uuid.py", line 181, in __init__
    raise ValueError('badly formed hexadecimal UUID string')
ValueError: badly formed hexadecimal UUID string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py", line 59, in a2a_conversation_initiate
    initiator_agent = A2AAgent.objects.get(agent_id=data['initiator_agent_id'])
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 633, in get
    clone = self._chain() if self.query.combinator else self.filter(*args, **kwargs)
                                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1602, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1634, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ~~~~~~~~~~~~~~~~~^
        child,
        ^^^^^^
    ...<7 lines>...
        update_join_types=update_join_types,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1548, in build_filter
    condition = self.build_lookup(lookups, col, value)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/query.py", line 1378, in build_lookup
    lookup = lookup_class(lhs, rhs)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 30, in __init__
    self.rhs = self.get_prep_lookup()
               ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 362, in get_prep_lookup
    return super().get_prep_lookup()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/lookups.py", line 88, in get_prep_lookup
    return self.lhs.output_field.get_prep_value(self.rhs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2731, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/fields/__init__.py", line 2749, in to_python
    raise exceptions.ValidationError(
    ...<3 lines>...
    )
django.core.exceptions.ValidationError: ['“salesforce_collections_agent” is not a valid UUID.']
ERROR 2025-09-21 20:06:09,980 log 45076 6212579328 Internal Server Error: /api/v1/a2a/conversations/initiate/
ERROR 2025-09-21 20:06:09,980 basehttp 45076 6212579328 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 500 63
INFO 2025-09-21 20:06:09,983 basehttp 45076 6229405696 "GET /api/v1/a2a/agents/ HTTP/1.1" 200 1609
WARNING 2025-09-21 20:09:16,068 views 45076 6229405696 Invalid A2A signature
WARNING 2025-09-21 20:09:16,070 log 45076 6229405696 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:09:16,070 basehttp 45076 6229405696 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:09:30,682 views 45076 6229405696 Invalid A2A signature
WARNING 2025-09-21 20:09:30,684 log 45076 6229405696 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:09:30,685 basehttp 45076 6229405696 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:10:06,472 views 45076 6229405696 Invalid A2A signature
WARNING 2025-09-21 20:10:06,474 log 45076 6229405696 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-21 20:10:06,475 basehttp 45076 6229405696 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
INFO 2025-09-21 20:14:09,938 basehttp 45076 6246232064 "GET /api/v1/a2a/agents/ HTTP/1.1" 200 1609
WARNING 2025-09-21 20:17:48,778 views 45076 6263058432 Invalid A2A signature
WARNING 2025-09-21 20:17:48,780 log 45076 6263058432 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 20:17:48,781 basehttp 45076 6263058432 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:18:18,485 views 45076 6263058432 Invalid A2A signature
WARNING 2025-09-21 20:18:18,486 log 45076 6263058432 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 20:18:18,486 basehttp 45076 6263058432 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:18:22,583 views 45076 6263058432 Invalid A2A signature
WARNING 2025-09-21 20:18:22,585 log 45076 6263058432 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 20:18:22,585 basehttp 45076 6263058432 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
WARNING 2025-09-21 20:18:23,365 views 45076 6263058432 Invalid A2A signature
WARNING 2025-09-21 20:18:23,366 log 45076 6263058432 Unauthorized: /api/v1/a2a/conversations/initiate/
WARNING 2025-09-21 20:18:23,366 basehttp 45076 6263058432 "POST /api/v1/a2a/conversations/initiate/ HTTP/1.1" 401 57
INFO 2025-09-21 20:19:32,698 basehttp 45076 6212579328 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1247
INFO 2025-09-21 20:19:37,512 basehttp 45076 6212579328 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 1857
INFO 2025-09-21 20:19:41,434 basehttp 45076 6212579328 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-22 05:20:38,758 autoreload 44083 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-22 05:28:15,762 log 44083 6164393984 Not Found: /api/v1/payment-processing/payment-methods/
WARNING 2025-09-22 05:28:15,762 basehttp 44083 6164393984 "POST /api/v1/payment-processing/payment-methods/ HTTP/1.1" 404 4200
WARNING 2025-09-22 05:28:24,555 log 44083 6164393984 Bad Request: /api/v1/a2a/agents/register/
WARNING 2025-09-22 05:28:24,555 basehttp 44083 6164393984 "POST /api/v1/a2a/agents/register/ HTTP/1.1" 400 75
WARNING 2025-09-22 06:00:02,523 log 44083 13170143232 Not Found: /
WARNING 2025-09-22 06:00:02,524 basehttp 44083 13170143232 "GET / HTTP/1.1" 404 2986
WARNING 2025-09-22 06:00:06,985 log 44083 13170143232 Not Found: /dev-ui
WARNING 2025-09-22 06:00:06,985 basehttp 44083 13170143232 "GET /dev-ui HTTP/1.1" 404 3022
WARNING 2025-09-22 06:00:10,277 log 44083 13170143232 Not Found: /agents
WARNING 2025-09-22 06:00:10,277 basehttp 44083 13170143232 "GET /agents HTTP/1.1" 404 3022
INFO 2025-09-22 06:00:13,627 basehttp 44083 13170143232 "GET /api/docs/ HTTP/1.1" 200 4478
WARNING 2025-09-22 06:01:04,670 log 44083 13170143232 Not Found: /
WARNING 2025-09-22 06:01:04,670 basehttp 44083 13170143232 "GET / HTTP/1.1" 404 2986
INFO 2025-09-22 06:18:56,417 autoreload 81590 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:19:07,441 autoreload 81743 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:19:11,264 autoreload 82018 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:19:30,080 autoreload 82018 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-22 06:19:30,446 autoreload 82515 8299364928 Watching for file changes with StatReloader
ERROR 2025-09-22 06:24:30,097 exception 82515 6130069504 Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-22 06:24:30,128 log 82515 6130069504 Bad Request: /api/v1/integration/overdue-invoices/
WARNING 2025-09-22 06:24:30,128 basehttp 82515 6130069504 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 400 74504
INFO 2025-09-22 06:25:16,913 basehttp 82515 6130069504 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 1857
ERROR 2025-09-22 06:32:38,257 exception 82515 6146895872 Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-22 06:32:38,282 log 82515 6146895872 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-22 06:32:38,283 basehttp 82515 6146895872 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 74096
ERROR 2025-09-22 06:33:42,182 exception 82515 6146895872 Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: 'e60313e65665.ngrok-free.app'. You may need to add 'e60313e65665.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-22 06:33:42,201 log 82515 6146895872 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-22 06:33:42,201 basehttp 82515 6146895872 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 74096
INFO 2025-09-22 06:34:14,128 autoreload 82515 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-22 06:34:14,634 autoreload 91561 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:37:13,115 views 91561 6193410048 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-21', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-777', 'invoice_id': 'INV-2024-777'}
INFO 2025-09-22 06:37:13,122 basehttp 91561 6193410048 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 168
INFO 2025-09-22 06:39:56,987 basehttp 91561 6193410048 "POST /api/v1/integration/slack/approval/ HTTP/1.1" 200 150
INFO 2025-09-22 06:42:51,648 autoreload 91561 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 06:42:52,196 autoreload 96726 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:42:59,955 autoreload 96726 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 06:43:00,446 autoreload 96738 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:43:24,534 autoreload 96738 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/slack_views.py changed, reloading.
INFO 2025-09-22 06:43:24,920 autoreload 97038 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:48:13,368 autoreload 97038 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/slack_views.py changed, reloading.
INFO 2025-09-22 06:48:13,805 autoreload 99839 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 06:49:15,566 autoreload 99839 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 06:49:15,917 autoreload 741 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:02:27,053 autoreload 10563 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:25,288 autoreload 10563 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:05:25,293 autoreload 741 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:05:25,842 autoreload 12397 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:25,842 autoreload 12396 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:41,794 autoreload 12397 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:05:41,795 autoreload 12396 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:05:42,231 autoreload 12609 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:42,231 autoreload 12610 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:56,985 autoreload 12609 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:05:56,992 autoreload 12610 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:05:57,355 autoreload 12725 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:05:57,355 autoreload 12724 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:03,906 autoreload 12725 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:06:03,907 autoreload 12724 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:06:04,344 autoreload 12836 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:04,344 autoreload 12837 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:09,876 autoreload 12837 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:06:09,882 autoreload 12836 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:06:10,314 autoreload 12847 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:10,314 autoreload 12848 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:13,822 autoreload 12848 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:06:13,822 autoreload 12847 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:06:14,243 autoreload 12951 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:14,243 autoreload 12952 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:29,017 autoreload 12951 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:06:29,021 autoreload 12952 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:06:29,413 autoreload 13060 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:06:29,413 autoreload 13061 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:07:59,050 autoreload 13061 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:07:59,055 autoreload 13060 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-22 07:07:59,575 autoreload 13974 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:07:59,575 autoreload 13975 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:09:22,162 autoreload 13974 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:09:22,624 autoreload 14855 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:09:25,286 autoreload 14855 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-22 07:09:25,721 autoreload 14954 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:09:27,204 autoreload 14954 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:09:27,564 autoreload 14958 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:14:37,247 autoreload 18242 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:15:14,720 autoreload 18242 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:15:15,192 autoreload 18665 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:15:20,901 autoreload 18665 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:15:21,324 autoreload 18768 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 07:18:01,465 autoreload 18768 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/a2a_broker/views.py changed, reloading.
INFO 2025-09-22 07:18:01,880 autoreload 20303 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-22 08:50:05,994 log 20303 6134771712 Not Found: /api/users/assessments-sessions/render/
WARNING 2025-09-22 08:50:05,995 basehttp 20303 6134771712 "GET /api/users/assessments-sessions/render/?uas_id=821458&section_id=3100&previous_section_id=3099 HTTP/1.1" 404 3181
WARNING 2025-09-22 08:50:53,909 log 20303 6134771712 Not Found: /api/users/assessments-sessions/render/
WARNING 2025-09-22 08:50:53,910 basehttp 20303 6134771712 "GET /api/users/assessments-sessions/render/?uas_id=821458&section_id=3100&previous_section_id=3099 HTTP/1.1" 404 3181
WARNING 2025-09-22 08:50:54,768 log 20303 6134771712 Not Found: /api/users/assessments-sessions/render/
WARNING 2025-09-22 08:50:54,769 basehttp 20303 6134771712 "GET /api/users/assessments-sessions/render/?uas_id=821458&section_id=3100&previous_section_id=3099 HTTP/1.1" 404 3181
WARNING 2025-09-22 08:50:55,483 log 20303 6134771712 Not Found: /api/users/assessments-sessions/render/
WARNING 2025-09-22 08:50:55,484 basehttp 20303 6134771712 "GET /api/users/assessments-sessions/render/?uas_id=821458&section_id=3100&previous_section_id=3099 HTTP/1.1" 404 3181
INFO 2025-09-22 10:30:44,643 autoreload 21131 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 10:43:27,826 basehttp 21131 6163902464 "GET /api/v1/integration/status/INV-2024-002/ HTTP/1.1" 200 1247
INFO 2025-09-22 10:43:37,656 basehttp 21131 6163902464 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 1857
INFO 2025-09-22 11:24:17,514 autoreload 21131 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-22 11:25:07,046 autoreload 48606 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 11:31:41,882 autoreload 54202 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 11:37:06,385 autoreload 60579 8299364928 Watching for file changes with StatReloader
INFO 2025-09-22 11:37:35,085 basehttp 60579 6134132736 "GET /api/v1/integration/overdue-invoices/ HTTP/1.1" 200 68
WARNING 2025-09-22 11:37:44,451 views 60579 6134132736 Invalid A2A signature
WARNING 2025-09-22 11:37:44,451 log 60579 6134132736 Unauthorized: /api/v1/a2a/agents/
WARNING 2025-09-22 11:37:44,452 basehttp 60579 6134132736 "GET /api/v1/a2a/agents/ HTTP/1.1" 401 57
WARNING 2025-09-22 11:37:55,273 views 60579 6134132736 Invalid AP2 signature
WARNING 2025-09-22 11:37:55,273 log 60579 6134132736 Unauthorized: /api/v1/ap2/processors/
WARNING 2025-09-22 11:37:55,273 basehttp 60579 6134132736 "GET /api/v1/ap2/processors/ HTTP/1.1" 401 57
INFO 2025-09-22 11:38:14,662 autoreload 60579 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-22 11:38:15,052 autoreload 61826 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:39:23,536 autoreload 30423 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:40:52,611 autoreload 33195 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:52:09,564 autoreload 33195 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 06:52:09,932 autoreload 36375 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:53:02,529 autoreload 36375 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 06:53:02,840 autoreload 36894 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:53:27,196 autoreload 37448 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:53:38,445 views 36894 6171979776 Salesforce webhook received: {'invoice_id': 'INV-DEMO-999', 'sf_invoice_id': 'SF-INV-DEMO-999', 'amount': 5500.0, 'currency': 'USD', 'customer_id': 'CUST-DEMO-999', 'customer_name': 'Demo Customer 999', 'mandate_id': 'MANDATE-DEMO-999', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'demo@example.com', 'idempotency_key': 'DEMO-999-2024-09-22'}
INFO 2025-09-23 06:53:38,469 a2a_ap2_integration 36894 6171979776 A2A conversation initiated: 892fbc5b-77e6-4356-86ea-1c5fc9a944db
INFO 2025-09-23 06:53:38,475 a2a_ap2_integration 36894 6171979776 AP2 payment initiated: ap2_1bdcc2fe670f4074 with status settled
INFO 2025-09-23 06:53:38,477 a2a_ap2_integration 36894 6171979776 A2A conversation 892fbc5b-77e6-4356-86ea-1c5fc9a944db completed with AP2 result.
INFO 2025-09-23 06:53:38,478 basehttp 36894 6171979776 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 432
WARNING 2025-09-23 06:53:43,120 log 36894 6171979776 Not Found: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-999/
WARNING 2025-09-23 06:53:43,121 basehttp 36894 6171979776 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-999/ HTTP/1.1" 404 5837
INFO 2025-09-23 06:53:55,366 autoreload 38734 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:53:56,310 autoreload 36894 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 06:53:56,524 autoreload 38800 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:55:03,690 autoreload 38800 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 06:55:04,036 autoreload 39513 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:56:15,106 autoreload 39513 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 06:56:15,505 autoreload 40213 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:56:51,817 views 40213 6130151424 Salesforce webhook received: {'invoice_id': 'INV-DEMO-FINAL', 'sf_invoice_id': 'SF-INV-DEMO-FINAL', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-DEMO-FINAL', 'customer_name': 'Final Demo Customer', 'mandate_id': 'MANDATE-DEMO-FINAL', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'demo@example.com', 'idempotency_key': 'DEMO-FINAL-2024-09-22'}
INFO 2025-09-23 06:56:51,838 a2a_ap2_integration 40213 6130151424 A2A conversation initiated: 87ba2d51-18f6-4177-bbdb-e2dcc1202c6b
INFO 2025-09-23 06:56:51,844 a2a_ap2_integration 40213 6130151424 AP2 payment initiated: ap2_d864cb8bff6f47b4 with status settled
INFO 2025-09-23 06:56:51,845 a2a_ap2_integration 40213 6130151424 A2A conversation 87ba2d51-18f6-4177-bbdb-e2dcc1202c6b completed with AP2 result.
INFO 2025-09-23 06:56:51,847 basehttp 40213 6130151424 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 436
ERROR 2025-09-23 06:56:59,876 views 40213 6130151424 Error displaying payment HTML: demo_payment_display.html
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 584, in get
    return render(request, 'demo_payment_display.html', {
        'payment_display': payment_display,
        'invoice_id': invoice_id
    })
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: demo_payment_display.html
ERROR 2025-09-23 06:56:59,878 log 40213 6130151424 Internal Server Error: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/
ERROR 2025-09-23 06:56:59,878 basehttp 40213 6130151424 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 500 125
INFO 2025-09-23 06:57:31,560 autoreload 40213 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 06:57:31,889 autoreload 41660 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:57:36,372 autoreload 41660 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 06:57:36,642 autoreload 41773 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 06:58:54,588 autoreload 43291 8299364928 Watching for file changes with StatReloader
ERROR 2025-09-23 06:59:28,197 views 43291 6136934400 Error displaying payment HTML: demo_payment_display.html
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 584, in get
    return render(request, 'demo_payment_display.html', {
        'payment_display': payment_display,
        'invoice_id': invoice_id
    })
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: demo_payment_display.html
ERROR 2025-09-23 06:59:28,201 log 43291 6136934400 Internal Server Error: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/
ERROR 2025-09-23 06:59:28,202 basehttp 43291 6136934400 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 500 125
ERROR 2025-09-23 07:00:11,814 views 43291 6136934400 Error displaying payment HTML: demo_payment_display.html
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 584, in get
    return render(request, 'demo_payment_display.html', {
        'payment_display': payment_display,
        'invoice_id': invoice_id
    })
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: demo_payment_display.html
ERROR 2025-09-23 07:00:11,818 log 43291 6136934400 Internal Server Error: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/
ERROR 2025-09-23 07:00:11,818 basehttp 43291 6136934400 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 500 125
ERROR 2025-09-23 07:00:13,626 views 43291 6136934400 Error displaying payment HTML: demo_payment_display.html
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 584, in get
    return render(request, 'demo_payment_display.html', {
        'payment_display': payment_display,
        'invoice_id': invoice_id
    })
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: demo_payment_display.html
ERROR 2025-09-23 07:00:13,629 log 43291 6136934400 Internal Server Error: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/
ERROR 2025-09-23 07:00:13,630 basehttp 43291 6136934400 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 500 125
ERROR 2025-09-23 07:00:20,932 views 43291 6136934400 Error displaying payment HTML: demo_payment_display.html
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 584, in get
    return render(request, 'demo_payment_display.html', {
        'payment_display': payment_display,
        'invoice_id': invoice_id
    })
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: demo_payment_display.html
ERROR 2025-09-23 07:00:20,933 log 43291 6136934400 Internal Server Error: /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/
ERROR 2025-09-23 07:00:20,933 basehttp 43291 6136934400 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 500 125
INFO 2025-09-23 07:01:01,481 autoreload 43291 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:01:01,881 autoreload 44616 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:01:11,780 basehttp 44616 6130003968 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 200 15588
INFO 2025-09-23 07:01:18,147 basehttp 44616 6130003968 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 200 15588
WARNING 2025-09-23 07:01:18,180 log 44616 6130003968 Not Found: /placeholder.svg
WARNING 2025-09-23 07:01:18,180 basehttp 44616 6130003968 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 07:01:45,190 autoreload 44616 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:01:45,516 autoreload 45510 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:01:58,209 autoreload 45510 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:01:58,516 autoreload 45722 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:02:00,912 autoreload 45722 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:02:01,171 autoreload 45732 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:02:01,808 basehttp 45732 6124711936 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 200 15588
WARNING 2025-09-23 07:02:01,827 log 45732 6124711936 Not Found: /placeholder.svg
WARNING 2025-09-23 07:02:01,827 basehttp 45732 6124711936 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 07:02:03,362 basehttp 45732 6124711936 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 200 15588
WARNING 2025-09-23 07:02:03,380 log 45732 6124711936 Not Found: /placeholder.svg
WARNING 2025-09-23 07:02:03,380 basehttp 45732 6124711936 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 07:03:01,089 basehttp 45732 6124711936 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-DEMO-FINAL/ HTTP/1.1" 200 15597
WARNING 2025-09-23 07:03:01,097 log 45732 6124711936 Not Found: /placeholder.svg
WARNING 2025-09-23 07:03:01,097 basehttp 45732 6124711936 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 07:04:25,938 views 45732 6158364672 Salesforce webhook received: {'invoice_id': 'INV-HACKATHON-2024', 'sf_invoice_id': 'SF-INV-HACKATHON-2024', 'amount': 12500.0, 'currency': 'USD', 'customer_id': 'CUST-HACKATHON-2024', 'customer_name': 'Hackathon Demo Corp', 'mandate_id': 'MANDATE-HACKATHON-2024', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'judge@hackathon.com', 'idempotency_key': 'HACKATHON-DEMO-2024-09-22'}
INFO 2025-09-23 07:04:25,968 a2a_ap2_integration 45732 6158364672 A2A conversation initiated: 8a6396fd-6398-49a4-8e65-8abb3eeeabd9
INFO 2025-09-23 07:04:25,973 a2a_ap2_integration 45732 6158364672 AP2 payment initiated: ap2_27422cae719f4f78 with status settled
INFO 2025-09-23 07:04:25,974 a2a_ap2_integration 45732 6158364672 A2A conversation 8a6396fd-6398-49a4-8e65-8abb3eeeabd9 completed with AP2 result.
INFO 2025-09-23 07:04:25,976 basehttp 45732 6158364672 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 444
INFO 2025-09-23 07:05:05,804 basehttp 45732 6124711936 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-HACKATHON-2024/ HTTP/1.1" 200 15597
WARNING 2025-09-23 07:05:05,832 log 45732 6124711936 Not Found: /placeholder.svg
WARNING 2025-09-23 07:05:05,832 basehttp 45732 6124711936 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 07:24:23,684 basehttp 45732 6124138496 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 148
INFO 2025-09-23 07:38:46,225 autoreload 45732 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:38:46,616 autoreload 67827 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:38:58,226 autoreload 67827 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:38:58,564 autoreload 67942 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:39:00,997 autoreload 67942 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:39:01,305 autoreload 67952 8299364928 Watching for file changes with StatReloader
ERROR 2025-09-23 07:40:40,875 salesforce_service 70245 8299364928 Salesforce authentication failed: 400 - {"error":"invalid_grant","error_description":"authentication failure"}
INFO 2025-09-23 07:41:11,478 autoreload 67952 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 07:41:11,821 autoreload 70618 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 07:42:32,528 salesforce_service 72967 8299364928 Successfully authenticated with Salesforce
INFO 2025-09-23 07:42:41,635 salesforce_service 73487 8299364928 Successfully authenticated with Salesforce
INFO 2025-09-23 07:42:42,248 salesforce_service 73487 8299364928 Successfully updated invoice INV-TEST-456 status to PAID in Salesforce
INFO 2025-09-23 07:42:57,236 views 70618 6168784896 Salesforce webhook received: {'invoice_id': 'INV-INTEGRATION-TEST', 'sf_invoice_id': 'SF-INV-INTEGRATION-TEST', 'amount': 8500.0, 'currency': 'USD', 'customer_id': 'CUST-INTEGRATION-TEST', 'customer_name': 'Integration Test Corp', 'mandate_id': 'MANDATE-INTEGRATION-TEST', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'test@integration.com', 'idempotency_key': 'INTEGRATION-TEST-2024-09-22'}
INFO 2025-09-23 07:42:57,255 a2a_ap2_integration 70618 6168784896 A2A conversation initiated: 7a71d018-aa21-4d27-b0b9-298f8642cfa9
INFO 2025-09-23 07:42:57,262 a2a_ap2_integration 70618 6168784896 AP2 payment initiated: ap2_77b0376991f4407d with status settled
INFO 2025-09-23 07:42:57,263 a2a_ap2_integration 70618 6168784896 A2A conversation 7a71d018-aa21-4d27-b0b9-298f8642cfa9 completed with AP2 result.
INFO 2025-09-23 07:42:57,264 basehttp 70618 6168784896 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 448
INFO 2025-09-23 07:43:05,603 basehttp 70618 6168784896 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 150
INFO 2025-09-23 08:38:55,457 basehttp 70618 6185611264 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-2024-777/ HTTP/1.1" 200 15597
WARNING 2025-09-23 08:38:55,486 log 70618 6185611264 Not Found: /placeholder.svg
WARNING 2025-09-23 08:38:55,487 basehttp 70618 6185611264 "GET /placeholder.svg HTTP/1.1" 404 3049
INFO 2025-09-23 08:42:25,579 views 70618 6169358336 Salesforce webhook received: {'invoice_id': 'INV-2024-0077', 'sf_invoice_id': 'SF-INV-0077', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech DEMO Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-23 08:42:25,590 basehttp 70618 6169358336 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 167
ERROR 2025-09-23 08:43:01,721 exception 70618 6186184704 Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-23 08:43:01,747 log 70618 6186184704 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-23 08:43:01,748 basehttp 70618 6186184704 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 75117
ERROR 2025-09-23 08:45:48,463 exception 70618 6186184704 Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-23 08:45:48,554 log 70618 6186184704 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-23 08:45:48,554 basehttp 70618 6186184704 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 75117
ERROR 2025-09-23 08:47:06,250 exception 70618 6186184704 Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/utils/deprecation.py", line 133, in __call__
    response = self.process_request(request)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/middleware/common.py", line 48, in process_request
    host = request.get_host()
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/http/request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '652eed6b442a.ngrok-free.app'. You may need to add '652eed6b442a.ngrok-free.app' to ALLOWED_HOSTS.
WARNING 2025-09-23 08:47:06,274 log 70618 6186184704 Bad Request: /api/v1/integration/salesforce/webhook/
WARNING 2025-09-23 08:47:06,275 basehttp 70618 6186184704 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 400 75117
INFO 2025-09-23 08:49:17,561 autoreload 70618 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 08:49:17,990 autoreload 93736 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 08:49:23,500 autoreload 93736 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 08:49:23,866 autoreload 93850 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 08:52:40,513 views 93850 6202470400 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-6685', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-779', 'invoice_id': 'INV-2024-779'}
ERROR 2025-09-23 08:52:40,527 views 93850 6202470400 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.

ERROR 2025-09-23 08:52:40,535 log 93850 6202470400 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 08:52:40,535 basehttp 93850 6202470400 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 08:54:53,097 views 93850 6219296768 Salesforce webhook received: {'invoice_id': 'INV-2024-779', 'sf_invoice_id': 'SF-INV-779', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-6685'}
ERROR 2025-09-23 08:54:53,105 views 93850 6219296768 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.

ERROR 2025-09-23 08:54:53,108 log 93850 6219296768 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 08:54:53,108 basehttp 93850 6219296768 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 08:56:18,520 autoreload 93850 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-23 08:56:18,849 autoreload 98275 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 08:57:17,889 views 98275 6164852736 Salesforce webhook received: {'invoice_id': 'INV-2024-780', 'sf_invoice_id': 'SF-INV-780', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-780-2024-09-22'}
INFO 2025-09-23 08:57:17,915 a2a_ap2_integration 98275 6164852736 A2A conversation initiated: 06b26754-b499-4ef1-9361-efd4fbe0e064
INFO 2025-09-23 08:57:17,921 a2a_ap2_integration 98275 6164852736 AP2 payment initiated: ap2_fc559ccf0a14418a with status settled
INFO 2025-09-23 08:57:17,922 a2a_ap2_integration 98275 6164852736 A2A conversation 06b26754-b499-4ef1-9361-efd4fbe0e064 completed with AP2 result.
INFO 2025-09-23 08:57:17,924 basehttp 98275 6164852736 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 432
INFO 2025-09-23 08:57:42,715 views 98275 6181679104 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-6685', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-779', 'invoice_id': 'INV-2024-779'}
ERROR 2025-09-23 08:57:42,722 views 98275 6181679104 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.

ERROR 2025-09-23 08:57:42,729 log 98275 6181679104 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 08:57:42,730 basehttp 98275 6181679104 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 08:58:01,121 views 98275 6198505472 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-6685', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-779', 'invoice_id': 'INV-2024-779'}
ERROR 2025-09-23 08:58:01,129 views 98275 6198505472 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.

ERROR 2025-09-23 08:58:01,133 log 98275 6198505472 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 08:58:01,133 basehttp 98275 6198505472 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 08:58:30,607 basehttp 98275 6215331840 "GET /api/v1/integration/stripe/payment-agent-sdk/INV-2024-780/ HTTP/1.1" 200 15597
INFO 2025-09-23 09:14:21,698 views 98275 6164852736 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-6685', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-779', 'invoice_id': 'INV-2024-779'}
ERROR 2025-09-23 09:14:21,711 views 98275 6164852736 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-779) already exists.

ERROR 2025-09-23 09:14:21,715 log 98275 6164852736 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 09:14:21,715 basehttp 98275 6164852736 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 09:17:14,332 views 98275 6215331840 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-2024-79999'}
INFO 2025-09-23 09:17:14,356 a2a_ap2_integration 98275 6215331840 A2A conversation initiated: d94c583a-05dd-40e2-b405-f4f8bd56c9d9
INFO 2025-09-23 09:17:14,363 a2a_ap2_integration 98275 6215331840 AP2 payment initiated: ap2_e1748df8a31d400f with status settled
INFO 2025-09-23 09:17:14,365 a2a_ap2_integration 98275 6215331840 A2A conversation d94c583a-05dd-40e2-b405-f4f8bd56c9d9 completed with AP2 result.
INFO 2025-09-23 09:17:14,367 basehttp 98275 6215331840 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 436
INFO 2025-09-23 09:17:45,723 views 98275 6232158208 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-2024-79999'}
INFO 2025-09-23 09:17:45,732 basehttp 98275 6232158208 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 169
INFO 2025-09-23 09:34:32,576 views 98275 6248984576 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Global Tech Corp', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-2024-79999'}
INFO 2025-09-23 09:34:32,594 basehttp 98275 6248984576 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 169
INFO 2025-09-23 09:48:02,817 views 98275 6164852736 Salesforce webhook received: {'invoice_id': 'INV-2024-800', 'sf_invoice_id': 'SF-INV-800', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-800-2024-09-22'}
INFO 2025-09-23 09:48:02,840 a2a_ap2_integration 98275 6164852736 A2A conversation initiated: 5691cff3-7a2c-4b45-bf3a-a6d2e105b355
INFO 2025-09-23 09:48:02,845 a2a_ap2_integration 98275 6164852736 AP2 payment initiated: ap2_ccf2acd2f02e404e with status settled
INFO 2025-09-23 09:48:02,846 a2a_ap2_integration 98275 6164852736 A2A conversation 5691cff3-7a2c-4b45-bf3a-a6d2e105b355 completed with AP2 result.
INFO 2025-09-23 09:48:02,848 basehttp 98275 6164852736 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 432
INFO 2025-09-23 11:33:29,884 autoreload 56387 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 11:34:30,191 views 56387 6169751552 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Divyanshu Bhati', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-2304'}
INFO 2025-09-23 11:34:30,205 basehttp 56387 6169751552 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 169
INFO 2025-09-23 11:35:51,443 views 56387 13170143232 Salesforce webhook received: {'invoice_id': 'INV-2024-0077', 'sf_invoice_id': 'SF-INV-0077', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech DEMO Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-23 11:35:51,451 basehttp 56387 13170143232 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 167
INFO 2025-09-23 11:35:53,868 views 56387 13170143232 Salesforce webhook received: {'invoice_id': 'INV-2024-0077', 'sf_invoice_id': 'SF-INV-0077', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech DEMO Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-777-2024-09-21'}
INFO 2025-09-23 11:35:53,874 basehttp 56387 13170143232 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 167
INFO 2025-09-23 11:41:15,395 views 56387 6169751552 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Divyanshu Bhati\t', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-99987'}
INFO 2025-09-23 11:41:15,402 basehttp 56387 6169751552 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 169
INFO 2025-09-23 11:42:21,224 autoreload 62032 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 11:42:29,339 views 62032 6165131264 Salesforce webhook received: {'idempotency_key': 'SF-INV-777-2024-09-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Divyanshu Bhati\t', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-79999', 'invoice_id': 'INV-878898'}
INFO 2025-09-23 11:42:29,349 basehttp 62032 6165131264 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 169
INFO 2025-09-23 11:44:26,550 views 62032 6165131264 Salesforce webhook received: {'idempotency_key': 'SF-INV-2389', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Divyanshu Mike', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-2389', 'invoice_id': 'INV-2389'}
INFO 2025-09-23 11:44:26,575 a2a_ap2_integration 62032 6165131264 A2A conversation initiated: 82302aca-b9f6-4345-926b-c634c6f0741b
INFO 2025-09-23 11:44:26,587 a2a_ap2_integration 62032 6165131264 AP2 payment initiated: ap2_c9693490c7394dff with status settled
INFO 2025-09-23 11:44:26,589 a2a_ap2_integration 62032 6165131264 A2A conversation 82302aca-b9f6-4345-926b-c634c6f0741b completed with AP2 result.
INFO 2025-09-23 11:44:26,592 basehttp 62032 6165131264 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 424
INFO 2025-09-23 12:29:52,336 views 62032 13035925504 Salesforce webhook received: {'idempotency_key': 'SF-INV-40238', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40238', 'invoice_id': 'INV-40238'}
INFO 2025-09-23 12:29:52,371 a2a_ap2_integration 62032 13035925504 A2A conversation initiated: 1fd0b028-9010-4f0c-b0e0-25d14022859a
INFO 2025-09-23 12:29:52,381 a2a_ap2_integration 62032 13035925504 AP2 payment initiated: ap2_f224a845b5534862 with status settled
INFO 2025-09-23 12:29:52,384 a2a_ap2_integration 62032 13035925504 A2A conversation 1fd0b028-9010-4f0c-b0e0-25d14022859a completed with AP2 result.
INFO 2025-09-23 12:29:52,389 basehttp 62032 13035925504 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 426
INFO 2025-09-23 12:38:12,598 autoreload 62032 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 12:38:13,059 autoreload 79453 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:38:21,635 autoreload 79453 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 12:38:22,020 autoreload 79572 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:39:15,487 autoreload 79572 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 12:39:15,820 autoreload 80081 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:39:27,399 autoreload 80081 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 12:39:27,720 autoreload 80205 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:40:44,713 autoreload 80205 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 12:40:45,106 autoreload 81028 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:40:55,676 autoreload 81028 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 12:40:55,987 autoreload 81153 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:42:17,976 autoreload 81153 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 12:42:18,322 autoreload 82075 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 12:42:51,196 log 82075 6122844160 Not Found: /api/v1/integration/pre-mandate-approval/INV-2024-801/
WARNING 2025-09-23 12:42:51,197 basehttp 82075 6122844160 "GET /api/v1/integration/pre-mandate-approval/INV-2024-801/ HTTP/1.1" 404 99
WARNING 2025-09-23 12:42:51,412 log 82075 6122844160 Not Found: /favicon.ico
WARNING 2025-09-23 12:42:51,413 basehttp 82075 6122844160 "GET /favicon.ico HTTP/1.1" 404 3050
WARNING 2025-09-23 12:43:44,202 log 82075 6122844160 Not Found: /api/v1/integration/pre-mandate-approval/INV-2024-801/
WARNING 2025-09-23 12:43:44,203 basehttp 82075 6122844160 "GET /api/v1/integration/pre-mandate-approval/INV-2024-801/ HTTP/1.1" 404 99
WARNING 2025-09-23 12:43:59,820 log 82075 6122844160 Not Found: /api/v1/integration/pre-mandate-approval/INV-2024-801/
WARNING 2025-09-23 12:43:59,820 basehttp 82075 6122844160 "GET /api/v1/integration/pre-mandate-approval/INV-2024-801/ HTTP/1.1" 404 99
INFO 2025-09-23 12:44:24,423 autoreload 83594 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 12:44:29,212 log 82075 6139670528 Not Found: /api/v1/integration/pre-mandate-approval/INV-2024-801/
WARNING 2025-09-23 12:44:29,212 basehttp 82075 6139670528 "GET /api/v1/integration/pre-mandate-approval/INV-2024-801/ HTTP/1.1" 404 99
INFO 2025-09-23 12:44:36,351 views 82075 6139670528 Salesforce webhook received: {'invoice_id': 'INV-2024-802', 'sf_invoice_id': 'SF-INV-802', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-802-2024-09-22'}
INFO 2025-09-23 12:44:36,371 a2a_ap2_integration 82075 6139670528 A2A conversation initiated: fa168bc4-cbbc-4348-a98a-0723262f0394
INFO 2025-09-23 12:44:36,377 a2a_ap2_integration 82075 6139670528 AP2 payment initiated: ap2_34228655682d45be with status settled
INFO 2025-09-23 12:44:36,378 a2a_ap2_integration 82075 6139670528 A2A conversation fa168bc4-cbbc-4348-a98a-0723262f0394 completed with AP2 result.
INFO 2025-09-23 12:44:36,380 basehttp 82075 6139670528 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 311
INFO 2025-09-23 12:44:52,414 basehttp 82075 6156496896 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10159
INFO 2025-09-23 12:45:05,298 salesforce_service 82075 6139670528 Successfully authenticated with Salesforce
ERROR 2025-09-23 12:45:05,861 salesforce_service 82075 6139670528 Failed to update pre_mandate status in Salesforce: 404 - [{"errorCode":"NOT_FOUND","message":"Provided external ID field does not exist or is not accessible: INV-2024-802"}]
ERROR 2025-09-23 12:45:05,864 log 82075 6139670528 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 12:45:05,864 basehttp 82075 6139670528 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
INFO 2025-09-23 12:45:26,355 autoreload 82075 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/salesforce_service.py changed, reloading.
INFO 2025-09-23 12:45:26,681 autoreload 85675 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:45:31,512 salesforce_service 85675 6199488512 Successfully authenticated with Salesforce
ERROR 2025-09-23 12:45:32,443 salesforce_service 85675 6199488512 Salesforce API returned error for pre_mandate update: Invoice not found
ERROR 2025-09-23 12:45:32,444 log 85675 6199488512 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 12:45:32,444 basehttp 85675 6199488512 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
INFO 2025-09-23 12:46:02,726 autoreload 85675 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/salesforce_service.py changed, reloading.
INFO 2025-09-23 12:46:03,007 autoreload 86433 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 12:47:13,703 basehttp 86433 6165622784 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10159
INFO 2025-09-23 12:47:19,690 salesforce_service 86433 6165622784 Successfully authenticated with Salesforce
ERROR 2025-09-23 12:47:20,317 salesforce_service 86433 6165622784 Salesforce API returned error for pre_mandate update: Invoice not found
ERROR 2025-09-23 12:47:20,318 log 86433 6165622784 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 12:47:20,319 basehttp 86433 6165622784 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
INFO 2025-09-23 12:50:33,078 views 86433 6182449152 Salesforce webhook received: {'idempotency_key': 'SF-INV-40238', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40238', 'invoice_id': 'INV-40238'}
INFO 2025-09-23 12:50:33,092 basehttp 86433 6182449152 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 164
INFO 2025-09-23 12:51:29,390 autoreload 86433 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/salesforce_service.py changed, reloading.
INFO 2025-09-23 12:51:29,745 autoreload 89702 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 12:53:20,812 log 89702 6161281024 Not Found: /api/v1/integration/pre-mandate-approval/INV-2024-801/
WARNING 2025-09-23 12:53:20,813 basehttp 89702 6161281024 "GET /api/v1/integration/pre-mandate-approval/INV-2024-801/ HTTP/1.1" 404 99
WARNING 2025-09-23 12:53:20,983 log 89702 6161281024 Not Found: /favicon.ico
WARNING 2025-09-23 12:53:20,983 basehttp 89702 6161281024 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 12:53:32,436 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10159
INFO 2025-09-23 13:00:39,785 basehttp 89702 6161281024 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10153
WARNING 2025-09-23 13:00:40,439 log 89702 12901707776 Not Found: /favicon.ico
WARNING 2025-09-23 13:00:40,440 basehttp 89702 12901707776 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 13:00:43,799 basehttp 89702 12918534144 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10153
INFO 2025-09-23 13:02:41,746 basehttp 89702 6161281024 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10153
INFO 2025-09-23 13:03:51,781 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10168
INFO 2025-09-23 13:03:52,013 views 89702 12935360512 Salesforce webhook received: {'idempotency_key': 'SF-INV-40238', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40238', 'invoice_id': 'INV-40238'}
INFO 2025-09-23 13:03:52,025 basehttp 89702 12935360512 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 164
INFO 2025-09-23 13:03:59,842 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10168
INFO 2025-09-23 13:04:04,239 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10159
INFO 2025-09-23 13:04:20,051 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10159
INFO 2025-09-23 13:04:23,622 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10168
INFO 2025-09-23 13:04:30,463 basehttp 89702 12901707776 "GET /api/v1/integration/pre-mandate-approval/INV-2024-802/ HTTP/1.1" 200 10177
INFO 2025-09-23 13:05:23,188 views 89702 6161281024 Salesforce webhook received: {'idempotency_key': 'SF-INV-40239', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40239', 'invoice_id': 'INV-40239'}
INFO 2025-09-23 13:05:23,214 a2a_ap2_integration 89702 6161281024 A2A conversation initiated: 6e7d5ae8-5029-4b61-8f88-cb5c928937ba
INFO 2025-09-23 13:05:23,223 a2a_ap2_integration 89702 6161281024 AP2 payment initiated: ap2_0fe43acb7f8a4ac8 with status settled
INFO 2025-09-23 13:05:23,225 a2a_ap2_integration 89702 6161281024 A2A conversation 6e7d5ae8-5029-4b61-8f88-cb5c928937ba completed with AP2 result.
INFO 2025-09-23 13:05:23,227 basehttp 89702 6161281024 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 308
INFO 2025-09-23 13:07:32,365 views 89702 6161281024 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:07:32,386 a2a_ap2_integration 89702 6161281024 A2A conversation initiated: 5b0581c8-dd4e-477e-b01e-046faab2cc62
INFO 2025-09-23 13:07:32,392 a2a_ap2_integration 89702 6161281024 AP2 payment initiated: ap2_27df86af3da74f2d with status settled
INFO 2025-09-23 13:07:32,395 a2a_ap2_integration 89702 6161281024 A2A conversation 5b0581c8-dd4e-477e-b01e-046faab2cc62 completed with AP2 result.
INFO 2025-09-23 13:07:32,397 basehttp 89702 6161281024 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 308
INFO 2025-09-23 13:07:58,164 basehttp 89702 12918534144 "GET /api/v1/integration/pre-mandate-approval/INV-40250/ HTTP/1.1" 200 10171
WARNING 2025-09-23 13:07:58,841 log 89702 12935360512 Not Found: /favicon.ico
WARNING 2025-09-23 13:07:58,841 basehttp 89702 12935360512 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 13:08:06,019 basehttp 89702 12952186880 "GET /api/v1/integration/pre-mandate-approval/INV-40250/ HTTP/1.1" 200 10171
INFO 2025-09-23 13:08:25,214 basehttp 89702 12969013248 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:08:29,669 basehttp 89702 12985839616 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:08:30,967 basehttp 89702 12985839616 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:08:32,179 basehttp 89702 12985839616 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:08:32,357 basehttp 89702 12985839616 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:08:32,527 basehttp 89702 12985839616 "GET /api/v1/integration/pre-mandate-approval/INV-40238/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:14:19,578 basehttp 89702 6161281024 "GET /api/v1/integration/pre-mandate-approval/INV-40250/ HTTP/1.1" 200 10180
INFO 2025-09-23 13:14:36,695 salesforce_service 89702 6325039104 Successfully authenticated with Salesforce
ERROR 2025-09-23 13:14:37,424 salesforce_service 89702 6325039104 Salesforce API returned error for pre_mandate update: Error: Update failed. First exception on row 0; first error: MISSING_ARGUMENT, Id not specified in an update call: []
ERROR 2025-09-23 13:14:37,428 log 89702 6325039104 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 13:14:37,428 basehttp 89702 6325039104 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
INFO 2025-09-23 13:15:26,731 salesforce_service 89702 6341865472 Successfully updated pre_mandate to True for invoice INV-40250 in Salesforce
INFO 2025-09-23 13:15:26,743 basehttp 89702 6341865472 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 200 159
INFO 2025-09-23 13:19:58,283 views 89702 6161281024 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:19:58,296 basehttp 89702 6161281024 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 175
INFO 2025-09-23 13:23:21,538 views 89702 6325039104 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:23:21,549 basehttp 89702 6325039104 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 175
INFO 2025-09-23 13:29:00,811 views 89702 6358691840 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:29:00,821 basehttp 89702 6358691840 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 175
INFO 2025-09-23 13:29:34,056 views 89702 6375518208 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:29:34,064 basehttp 89702 6375518208 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 175
INFO 2025-09-23 13:30:04,628 views 89702 6161281024 Salesforce webhook received: {'idempotency_key': 'SF-INV-40250', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40250', 'invoice_id': 'INV-40250'}
INFO 2025-09-23 13:30:04,635 basehttp 89702 6161281024 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 175
INFO 2025-09-23 13:32:19,613 views 89702 6325039104 Salesforce webhook received: {'idempotency_key': 'SF-INV-40257', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40257', 'invoice_id': 'INV-40257'}
INFO 2025-09-23 13:32:19,656 a2a_ap2_integration 89702 6325039104 A2A conversation initiated: d7bba245-970a-47d3-9c62-1c6bfff69893
INFO 2025-09-23 13:32:19,667 a2a_ap2_integration 89702 6325039104 AP2 payment initiated: ap2_8d450f0e49c44356 with status settled
INFO 2025-09-23 13:32:19,670 a2a_ap2_integration 89702 6325039104 A2A conversation d7bba245-970a-47d3-9c62-1c6bfff69893 completed with AP2 result.
INFO 2025-09-23 13:32:19,674 basehttp 89702 6325039104 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 308
INFO 2025-09-23 13:33:46,492 basehttp 89702 6341865472 "GET /api/v1/integration/pre-mandate-approval/INV-40257/ HTTP/1.1" 200 10180
WARNING 2025-09-23 13:33:47,107 log 89702 6358691840 Not Found: /favicon.ico
WARNING 2025-09-23 13:33:47,108 basehttp 89702 6358691840 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 13:33:49,057 basehttp 89702 6375518208 "GET /api/v1/integration/pre-mandate-approval/INV-40257/ HTTP/1.1" 200 10180
WARNING 2025-09-23 13:56:51,626 log 83594 6165147648 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 13:56:51,627 basehttp 83594 6165147648 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 13:59:12,552 autoreload 25077 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 13:59:46,636 log 25077 6138916864 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 13:59:46,636 basehttp 25077 6138916864 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:06:00,154 autoreload 83594 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:06:00,157 autoreload 25077 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:06:00,613 autoreload 29308 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:06:00,613 autoreload 29309 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:06:23,426 log 29308 6136737792 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:06:23,426 basehttp 29308 6136737792 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:06:27,528 autoreload 29309 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:06:27,563 autoreload 29308 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:06:27,999 autoreload 29547 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:06:27,999 autoreload 29546 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:07:05,395 log 29547 6125613056 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:07:05,396 basehttp 29547 6125613056 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:07:08,076 autoreload 29546 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:07:08,105 autoreload 29547 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:07:08,474 autoreload 29985 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:08,474 autoreload 29984 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:07:09,669 log 29985 6168539136 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:07:09,669 basehttp 29985 6168539136 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:07:11,698 log 29985 6168539136 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:07:11,698 basehttp 29985 6168539136 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:07:12,527 log 29985 6185365504 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:07:12,527 basehttp 29985 6185365504 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:07:12,655 log 29985 6185365504 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:07:12,655 basehttp 29985 6185365504 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:07:13,980 autoreload 29985 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:13,981 autoreload 29984 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:14,321 autoreload 30099 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:14,321 autoreload 30100 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:16,665 autoreload 30099 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:07:16,666 autoreload 30100 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:07:16,984 autoreload 30121 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:16,984 autoreload 30120 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:46,780 autoreload 30120 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:46,781 autoreload 30121 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:47,133 autoreload 30459 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:47,134 autoreload 30460 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:53,692 autoreload 30460 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:53,694 autoreload 30459 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:53,970 autoreload 30577 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:53,970 autoreload 30576 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:55,312 autoreload 30577 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:55,315 autoreload 30576 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:07:55,628 autoreload 30588 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:07:55,628 autoreload 30589 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:08:02,507 log 30589 6199308288 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:02,508 basehttp 30589 6199308288 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:08:04,808 log 30589 6199308288 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:04,808 basehttp 30589 6199308288 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:08:05,688 log 30589 6199308288 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:05,688 basehttp 30589 6199308288 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:08:08,148 log 30589 6216134656 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:08,148 basehttp 30589 6216134656 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:08:24,132 log 30589 6232961024 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:24,133 basehttp 30589 6232961024 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:08:27,232 log 30589 6232961024 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:08:27,232 basehttp 30589 6232961024 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:08:55,659 views 30589 6249787392 Salesforce webhook received: {'invoice_id': 'INV-2024-805', 'sf_invoice_id': 'SF-INV-805', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-805-2024-09-22'}
INFO 2025-09-23 14:08:56,378 salesforce_service 30589 6249787392 Successfully authenticated with Salesforce
ERROR 2025-09-23 14:08:56,832 salesforce_service 30589 6249787392 Failed to get pre-mandate status from Salesforce: 400 - [{"message":"\nSELECT pre_mandate__c FROM Account WHERE\n       ^\nERROR at Row:1:Column:8\nNo such column 'pre_mandate__c' on entity 'Account'. If you are attempting to use a custom field, be sure to append the '__c' after the custom field name. Please reference your WSDL or the describe call for the appropriate names.","errorCode":"INVALID_FIELD"}]
INFO 2025-09-23 14:08:56,834 views 30589 6249787392 Pre-mandate is true for invoice INV-2024-805, proceeding with payment processing
INFO 2025-09-23 14:08:56,852 a2a_ap2_integration 30589 6249787392 A2A conversation initiated: 10ebbd2c-4a87-48d7-bef3-e2e904a714c4
INFO 2025-09-23 14:08:56,864 a2a_ap2_integration 30589 6249787392 AP2 payment initiated: ap2_3e1b9b2785c34be0 with status settled
INFO 2025-09-23 14:08:56,866 a2a_ap2_integration 30589 6249787392 A2A conversation 10ebbd2c-4a87-48d7-bef3-e2e904a714c4 completed with AP2 result.
INFO 2025-09-23 14:08:56,868 basehttp 30589 6249787392 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 311
INFO 2025-09-23 14:09:10,512 basehttp 30589 6249787392 "GET /api/v1/integration/pre-mandate-approval/INV-2024-805/ HTTP/1.1" 200 13344
INFO 2025-09-23 14:09:24,806 basehttp 30589 6249787392 "GET /api/v1/integration/pre-mandate-approval/INV-2024-805/ HTTP/1.1" 200 13344
ERROR 2025-09-23 14:09:27,292 salesforce_service 30589 6249787392 Salesforce API returned error for pre_mandate update: Invoice not found
ERROR 2025-09-23 14:09:27,295 log 30589 6249787392 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 14:09:27,295 basehttp 30589 6249787392 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
WARNING 2025-09-23 14:09:36,393 log 30589 6199308288 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:09:36,394 basehttp 30589 6199308288 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:09:39,139 log 30589 6216134656 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:09:39,140 basehttp 30589 6216134656 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:10:11,509 log 30589 6232961024 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:10:11,510 basehttp 30589 6232961024 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:16:01,833 autoreload 30589 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/salesforce_service.py changed, reloading.
INFO 2025-09-23 14:16:02,215 autoreload 36448 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:16:57,997 views 36448 6205894656 Salesforce webhook received: {'invoice_id': 'INV-2024-806', 'sf_invoice_id': 'SF-INV-806', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-806-2024-09-22'}
INFO 2025-09-23 14:16:58,733 salesforce_service 36448 6205894656 Successfully authenticated with Salesforce
ERROR 2025-09-23 14:16:59,393 salesforce_service 36448 6205894656 Failed to get pre-mandate status from Salesforce: 400 - [{"message":"\npre_approved__c FROM Account WHERE Invoice_ID__c = 'INV-2024-806' LIMIT\n                                   ^\nERROR at Row:1:Column:43\nNo such column 'Invoice_ID__c' on entity 'Account'. If you are attempting to use a custom field, be sure to append the '__c' after the custom field name. Please reference your WSDL or the describe call for the appropriate names.","errorCode":"INVALID_FIELD"}]
INFO 2025-09-23 14:16:59,395 views 36448 6205894656 Pre-mandate is true for invoice INV-2024-806, proceeding with payment processing
INFO 2025-09-23 14:16:59,409 a2a_ap2_integration 36448 6205894656 A2A conversation initiated: 138d1b87-8357-43b1-af9f-17fbb09d3717
INFO 2025-09-23 14:16:59,419 a2a_ap2_integration 36448 6205894656 AP2 payment initiated: ap2_0495bd102fc34a3f with status settled
INFO 2025-09-23 14:16:59,420 a2a_ap2_integration 36448 6205894656 A2A conversation 138d1b87-8357-43b1-af9f-17fbb09d3717 completed with AP2 result.
INFO 2025-09-23 14:16:59,423 basehttp 36448 6205894656 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 311
INFO 2025-09-23 14:17:25,051 autoreload 36448 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/salesforce_service.py changed, reloading.
INFO 2025-09-23 14:17:25,394 autoreload 37920 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:17:27,098 log 37920 6202667008 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:17:27,098 basehttp 37920 6202667008 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:17:28,857 log 37920 6219493376 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:17:28,858 basehttp 37920 6219493376 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:17:30,236 log 37920 6219493376 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:17:30,236 basehttp 37920 6219493376 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:18:22,436 log 37920 6236319744 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:18:22,437 basehttp 37920 6236319744 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:25:45,446 autoreload 30588 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:25:45,896 autoreload 43000 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:25:46,284 autoreload 37920 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:25:46,553 autoreload 43004 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:25:49,362 autoreload 43000 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:25:49,601 autoreload 43020 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:25:49,894 autoreload 43004 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:25:50,144 autoreload 43023 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:01,089 autoreload 43020 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:01,463 autoreload 43137 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:01,655 autoreload 43023 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:01,913 autoreload 43139 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:05,832 autoreload 43137 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:06,115 autoreload 43244 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:06,281 autoreload 43139 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:06,541 autoreload 43246 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:51,132 autoreload 43244 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:51,431 autoreload 43682 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:26:51,566 autoreload 43246 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:26:51,817 autoreload 43683 8299364928 Watching for file changes with StatReloader
WARNING 2025-09-23 14:27:14,233 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:27:14,234 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:27:14,352 log 43683 6164066304 Not Found: /favicon.ico
WARNING 2025-09-23 14:27:14,353 basehttp 43683 6164066304 "GET /favicon.ico HTTP/1.1" 404 3050
WARNING 2025-09-23 14:27:15,264 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:27:15,265 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:27:15,615 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:27:15,616 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:27:17,030 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:27:17,030 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:27:22,132 log 43683 6180892672 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:27:22,133 basehttp 43683 6180892672 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:29:13,481 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:29:13,482 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:29:13,607 log 43683 6164066304 Not Found: /favicon.ico
WARNING 2025-09-23 14:29:13,608 basehttp 43683 6164066304 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 14:29:36,394 views 43683 6180892672 Salesforce webhook received: {'invoice_id': 'INV-2024-808', 'sf_invoice_id': 'SF-INV-808', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-777', 'customer_name': 'Global Tech Corp', 'mandate_id': 'MANDATE-777', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-808-2024-09-22'}
INFO 2025-09-23 14:29:36,408 views 43683 6180892672 Processing payment for invoice INV-2024-808 (pre_approved__c = true)
INFO 2025-09-23 14:29:36,416 a2a_ap2_integration 43683 6180892672 A2A conversation initiated: 7bcc2e84-b514-4f03-83b5-0bd172fb78b7
INFO 2025-09-23 14:29:36,420 a2a_ap2_integration 43683 6180892672 AP2 payment initiated: ap2_79d97f3418854d7d with status settled
INFO 2025-09-23 14:29:36,422 a2a_ap2_integration 43683 6180892672 A2A conversation 7bcc2e84-b514-4f03-83b5-0bd172fb78b7 completed with AP2 result.
INFO 2025-09-23 14:29:36,423 basehttp 43683 6180892672 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 311
INFO 2025-09-23 14:29:49,946 basehttp 43683 6197719040 "GET /api/v1/integration/pre-mandate-approval/INV-2024-808/ HTTP/1.1" 200 10760
WARNING 2025-09-23 14:30:36,656 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:30:36,657 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:30:39,516 log 43683 6180892672 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:30:39,516 basehttp 43683 6180892672 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
WARNING 2025-09-23 14:30:42,221 log 43683 6197719040 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:30:42,222 basehttp 43683 6197719040 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:31:43,186 basehttp 43683 6214545408 "GET /api/v1/integration/pre-mandate-approval/INV-40250/ HTTP/1.1" 200 10765
WARNING 2025-09-23 14:32:50,376 log 43683 6164066304 Not Found: /api/v1/integration/pre-mandate-approval/INV-40287/
WARNING 2025-09-23 14:32:50,377 basehttp 43683 6164066304 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 404 96
INFO 2025-09-23 14:34:12,903 views 43683 6180892672 Salesforce webhook received: {'idempotency_key': 'SF-INV-40287', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40287', 'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:34:12,918 views 43683 6180892672 Processing payment for invoice INV-40287 (pre_approved__c = true)
INFO 2025-09-23 14:34:12,931 a2a_ap2_integration 43683 6180892672 A2A conversation initiated: 3add68f5-5285-4015-b71a-ff151f6e2975
INFO 2025-09-23 14:34:12,940 a2a_ap2_integration 43683 6180892672 AP2 payment initiated: ap2_cc541e816d1e4a0b with status settled
INFO 2025-09-23 14:34:12,944 a2a_ap2_integration 43683 6180892672 A2A conversation 3add68f5-5285-4015-b71a-ff151f6e2975 completed with AP2 result.
INFO 2025-09-23 14:34:12,947 basehttp 43683 6180892672 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 308
INFO 2025-09-23 14:35:00,069 views 43683 6164066304 Salesforce webhook received: {'idempotency_key': 'SF-INV-40287', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-40287', 'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:35:00,082 basehttp 43683 6164066304 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 164
INFO 2025-09-23 14:35:00,204 autoreload 43683 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:00,572 autoreload 49456 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:00,981 autoreload 43682 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:01,202 autoreload 49460 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:08,098 autoreload 49456 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:08,390 autoreload 49577 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:08,617 autoreload 49460 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:08,883 autoreload 49580 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:11,773 autoreload 49577 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:12,079 autoreload 49594 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:12,243 autoreload 49580 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:12,509 autoreload 49598 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:13,407 autoreload 49594 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:13,673 autoreload 49601 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:13,818 autoreload 49598 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:35:14,098 autoreload 49677 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 Request path: /api/v1/integration/pre-mandate-approval/INV-40287/
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 Request method: GET
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 URL kwargs: {'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 URL args: ()
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 Requested invoice_id: 'INV-40287'
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:35:29,793 views 49601 6201077760 Requested invoice_id length: 9
INFO 2025-09-23 14:35:29,805 views 49601 6201077760 Total invoices in database: 28
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:35:29,807 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,808 views 49601 6201077760   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:29,809 views 49601 6201077760 Found invoice with exact match: INV-40287
INFO 2025-09-23 14:35:29,812 basehttp 49601 6201077760 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:35:48,595 views 49601 6201077760 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:35:48,595 views 49601 6201077760 Request path: /api/v1/integration/pre-mandate-approval/INV-40287/
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 Request method: GET
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 URL kwargs: {'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 URL args: ()
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 Requested invoice_id: 'INV-40287'
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:35:48,596 views 49601 6201077760 Requested invoice_id length: 9
INFO 2025-09-23 14:35:48,612 views 49601 6201077760 Total invoices in database: 28
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:48,614 views 49601 6201077760   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,615 views 49601 6201077760   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:48,616 views 49601 6201077760 Found invoice with exact match: INV-40287
INFO 2025-09-23 14:35:48,617 basehttp 49601 6201077760 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 Request path: /api/v1/integration/pre-mandate-approval/INV-40287/
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 Request method: GET
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 URL kwargs: {'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 URL args: ()
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 Requested invoice_id: 'INV-40287'
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:35:54,447 views 49601 6217904128 Requested invoice_id length: 9
INFO 2025-09-23 14:35:54,460 views 49601 6217904128 Total invoices in database: 28
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:54,462 views 49601 6217904128   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,463 views 49601 6217904128   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:54,464 views 49601 6217904128 Found invoice with exact match: INV-40287
INFO 2025-09-23 14:35:54,465 basehttp 49601 6217904128 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:35:58,357 views 49601 6234730496 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:35:58,358 views 49601 6234730496 Request path: /api/v1/integration/pre-mandate-approval/INV-40287/
INFO 2025-09-23 14:35:58,358 views 49601 6234730496 Request method: GET
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 URL kwargs: {'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 URL args: ()
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 Requested invoice_id: 'INV-40287'
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:35:58,359 views 49601 6234730496 Requested invoice_id length: 9
INFO 2025-09-23 14:35:58,368 views 49601 6234730496 Total invoices in database: 28
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,371 views 49601 6234730496   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,372 views 49601 6234730496   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,372 views 49601 6234730496   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,372 views 49601 6234730496   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,372 views 49601 6234730496   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,372 views 49601 6234730496   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:35:58,373 views 49601 6234730496 Found invoice with exact match: INV-40287
INFO 2025-09-23 14:35:58,374 basehttp 49601 6234730496 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 Request path: /api/v1/integration/pre-mandate-approval/INV-99099/
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 Request method: GET
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 URL kwargs: {'invoice_id': 'INV-99099'}
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 URL args: ()
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 Requested invoice_id: 'INV-99099'
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:37:21,408 views 49601 6201077760 Requested invoice_id length: 9
INFO 2025-09-23 14:37:21,429 views 49601 6201077760 Total invoices in database: 28
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,430 views 49601 6201077760   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,431 views 49601 6201077760   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,431 views 49601 6201077760   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:21,431 views 49601 6201077760   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
WARNING 2025-09-23 14:37:21,431 views 49601 6201077760 No exact match found for invoice_id: 'INV-99099'
WARNING 2025-09-23 14:37:21,432 views 49601 6201077760 No case-insensitive match found for invoice_id: 'INV-99099'
INFO 2025-09-23 14:37:21,434 views 49601 6201077760 Found 0 invoices containing 'INV-99099':
WARNING 2025-09-23 14:37:21,434 log 49601 6201077760 Not Found: /api/v1/integration/pre-mandate-approval/INV-99099/
WARNING 2025-09-23 14:37:21,434 basehttp 49601 6201077760 "GET /api/v1/integration/pre-mandate-approval/INV-99099/ HTTP/1.1" 404 192
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 Request path: /api/v1/integration/pre-mandate-approval/INV-99099/
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 Request method: GET
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 URL kwargs: {'invoice_id': 'INV-99099'}
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 URL args: ()
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 Requested invoice_id: 'INV-99099'
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:37:22,737 views 49601 6251556864 Requested invoice_id length: 9
INFO 2025-09-23 14:37:22,746 views 49601 6251556864 Total invoices in database: 28
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,748 views 49601 6251556864   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:37:22,749 views 49601 6251556864   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
WARNING 2025-09-23 14:37:22,749 views 49601 6251556864 No exact match found for invoice_id: 'INV-99099'
WARNING 2025-09-23 14:37:22,750 views 49601 6251556864 No case-insensitive match found for invoice_id: 'INV-99099'
INFO 2025-09-23 14:37:22,750 views 49601 6251556864 Found 0 invoices containing 'INV-99099':
WARNING 2025-09-23 14:37:22,751 log 49601 6251556864 Not Found: /api/v1/integration/pre-mandate-approval/INV-99099/
WARNING 2025-09-23 14:37:22,751 basehttp 49601 6251556864 "GET /api/v1/integration/pre-mandate-approval/INV-99099/ HTTP/1.1" 404 192
INFO 2025-09-23 14:39:00,694 views 49601 6201077760 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:39:00,694 views 49601 6201077760 Request path: /api/v1/integration/pre-mandate-approval/INV-40257/
INFO 2025-09-23 14:39:00,694 views 49601 6201077760 Request method: GET
INFO 2025-09-23 14:39:00,694 views 49601 6201077760 URL kwargs: {'invoice_id': 'INV-40257'}
INFO 2025-09-23 14:39:00,694 views 49601 6201077760 URL args: ()
INFO 2025-09-23 14:39:00,695 views 49601 6201077760 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:39:00,695 views 49601 6201077760 Requested invoice_id: 'INV-40257'
INFO 2025-09-23 14:39:00,695 views 49601 6201077760 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:39:00,695 views 49601 6201077760 Requested invoice_id length: 9
INFO 2025-09-23 14:39:00,706 views 49601 6201077760 Total invoices in database: 28
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,708 views 49601 6201077760   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:39:00,716 views 49601 6201077760 Found invoice with exact match: INV-40257
INFO 2025-09-23 14:39:00,717 basehttp 49601 6201077760 "GET /api/v1/integration/pre-mandate-approval/INV-40257/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:39:18,607 autoreload 49601 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:39:18,699 autoreload 49677 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:39:18,967 autoreload 52637 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:39:18,987 autoreload 52638 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 Request path: /api/v1/integration/pre-mandate-approval/INV-40287/
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 Request method: GET
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 URL kwargs: {'invoice_id': 'INV-40287'}
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 URL args: ()
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 Requested invoice_id: 'INV-40287'
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:40:55,707 views 52637 6215987200 Requested invoice_id length: 9
INFO 2025-09-23 14:40:55,722 views 52637 6215987200 Total invoices in database: 28
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,725 views 52637 6215987200   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,726 views 52637 6215987200   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:40:55,727 views 52637 6215987200 Found invoice with exact match: INV-40287
INFO 2025-09-23 14:40:55,731 basehttp 52637 6215987200 "GET /api/v1/integration/pre-mandate-approval/INV-40287/ HTTP/1.1" 200 10754
INFO 2025-09-23 14:42:24,754 autoreload 52638 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:42:24,754 autoreload 52637 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:42:25,249 autoreload 54675 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:42:25,250 autoreload 54674 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:43:09,469 autoreload 54675 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:43:09,471 autoreload 54674 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:43:10,029 autoreload 55119 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:43:10,029 autoreload 55120 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:44:31,832 autoreload 55120 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:44:31,834 autoreload 55119 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:44:32,218 autoreload 55971 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:44:32,218 autoreload 55972 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:44:38,750 autoreload 55972 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:44:38,751 autoreload 55971 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:44:39,111 autoreload 56096 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:44:39,111 autoreload 56095 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:45:06,928 views 56096 6135984128 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:45:06,928 views 56096 6135984128 Request path: /api/v1/integration/pre-mandate-approval/INV-99099/
INFO 2025-09-23 14:45:06,928 views 56096 6135984128 Request method: GET
INFO 2025-09-23 14:45:06,928 views 56096 6135984128 URL kwargs: {'invoice_id': 'INV-99099'}
INFO 2025-09-23 14:45:06,928 views 56096 6135984128 URL args: ()
INFO 2025-09-23 14:45:06,929 views 56096 6135984128 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:45:06,929 views 56096 6135984128 Requested invoice_id: 'INV-99099'
INFO 2025-09-23 14:45:06,929 views 56096 6135984128 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:45:06,929 views 56096 6135984128 Requested invoice_id length: 9
INFO 2025-09-23 14:45:06,939 views 56096 6135984128 Total invoices in database: 28
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:45:06,941 views 56096 6135984128   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
WARNING 2025-09-23 14:45:06,943 views 56096 6135984128 No exact match found for invoice_id: 'INV-99099'
WARNING 2025-09-23 14:45:06,943 views 56096 6135984128 No case-insensitive match found for invoice_id: 'INV-99099'
INFO 2025-09-23 14:45:06,944 views 56096 6135984128 Found 0 invoices containing 'INV-99099':
WARNING 2025-09-23 14:45:06,944 log 56096 6135984128 Not Found: /api/v1/integration/pre-mandate-approval/INV-99099/
WARNING 2025-09-23 14:45:06,944 basehttp 56096 6135984128 "GET /api/v1/integration/pre-mandate-approval/INV-99099/ HTTP/1.1" 404 192
ERROR 2025-09-23 14:45:59,152 views 56096 6152810496 Error creating invoice for approval: duplicate key value violates unique constraint "invoices_idempotency_key_key"
DETAIL:  Key (idempotency_key)=() already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_idempotency_key_key"
DETAIL:  Key (idempotency_key)=() already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 983, in post
    invoice = Invoice.objects.create(
        invoice_id=invoice_id,
    ...<6 lines>...
        created_at=timezone.now()
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_idempotency_key_key"
DETAIL:  Key (idempotency_key)=() already exists.

ERROR 2025-09-23 14:45:59,158 log 56096 6152810496 Internal Server Error: /api/v1/integration/create-invoice-for-approval/
ERROR 2025-09-23 14:45:59,158 basehttp 56096 6152810496 "POST /api/v1/integration/create-invoice-for-approval/ HTTP/1.1" 500 115
INFO 2025-09-23 14:46:20,208 autoreload 56096 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:46:20,212 autoreload 56095 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 14:46:20,603 autoreload 57571 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:46:20,603 autoreload 57572 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:46:31,200 autoreload 57572 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:46:31,201 autoreload 57571 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:46:31,523 autoreload 57689 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:46:31,523 autoreload 57690 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:46:36,936 autoreload 57690 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:46:36,938 autoreload 57689 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:46:37,253 autoreload 57801 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:46:37,255 autoreload 57800 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 Request path: /api/v1/integration/pre-mandate-approval/INV-99099/
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 Request method: GET
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 URL kwargs: {'invoice_id': 'INV-99099'}
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 URL args: ()
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 Requested invoice_id: 'INV-99099'
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:47:17,273 views 57800 6160347136 Requested invoice_id length: 9
INFO 2025-09-23 14:47:17,282 views 57800 6160347136 Total invoices in database: 28
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:47:17,285 views 57800 6160347136   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
WARNING 2025-09-23 14:47:17,287 views 57800 6160347136 No exact match found for invoice_id: 'INV-99099'
WARNING 2025-09-23 14:47:17,288 views 57800 6160347136 No case-insensitive match found for invoice_id: 'INV-99099'
INFO 2025-09-23 14:47:17,289 views 57800 6160347136 Found 0 invoices containing 'INV-99099':
WARNING 2025-09-23 14:47:17,290 log 57800 6160347136 Not Found: /api/v1/integration/pre-mandate-approval/INV-99099/
WARNING 2025-09-23 14:47:17,290 basehttp 57800 6160347136 "GET /api/v1/integration/pre-mandate-approval/INV-99099/ HTTP/1.1" 404 192
INFO 2025-09-23 14:47:39,277 views 57800 6325039104 Created invoice INV-TEST-APPROVAL-002 for pre-mandate approval
INFO 2025-09-23 14:47:39,278 basehttp 57800 6325039104 "POST /api/v1/integration/create-invoice-for-approval/ HTTP/1.1" 200 239
INFO 2025-09-23 14:48:01,102 autoreload 57801 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:48:01,104 autoreload 57800 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 14:48:01,504 autoreload 59085 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:48:01,504 autoreload 59084 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 14:49:24,592 views 59085 6194425856 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 Request path: /api/v1/integration/pre-mandate-approval/INV-TEST-APPROVAL-002/
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 Request method: GET
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 URL kwargs: {'invoice_id': 'INV-TEST-APPROVAL-002'}
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 URL args: ()
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 Requested invoice_id: 'INV-TEST-APPROVAL-002'
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:49:24,593 views 59085 6194425856 Requested invoice_id length: 21
INFO 2025-09-23 14:49:24,604 views 59085 6194425856 Total invoices in database: 29
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-TEST-APPROVAL-002' (type: <class 'str'>, length: 21)
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,605 views 59085 6194425856   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,606 views 59085 6194425856   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:49:24,608 views 59085 6194425856 Found invoice with exact match: INV-TEST-APPROVAL-002
INFO 2025-09-23 14:49:24,612 basehttp 59085 6194425856 "GET /api/v1/integration/pre-mandate-approval/INV-TEST-APPROVAL-002/ HTTP/1.1" 200 10796
INFO 2025-09-23 14:49:59,989 salesforce_service 59085 6194425856 Successfully authenticated with Salesforce
ERROR 2025-09-23 14:50:00,823 salesforce_service 59085 6194425856 Salesforce API returned error for pre_mandate update: Invoice not found
ERROR 2025-09-23 14:50:00,827 log 59085 6194425856 Internal Server Error: /api/v1/integration/pre-mandate-decision/
ERROR 2025-09-23 14:50:00,828 basehttp 59085 6194425856 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 500 122
INFO 2025-09-23 14:50:38,431 views 59085 6194425856 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:50:38,431 views 59085 6194425856 Request path: /api/v1/integration/pre-mandate-approval/INV-99099/
INFO 2025-09-23 14:50:38,431 views 59085 6194425856 Request method: GET
INFO 2025-09-23 14:50:38,431 views 59085 6194425856 URL kwargs: {'invoice_id': 'INV-99099'}
INFO 2025-09-23 14:50:38,431 views 59085 6194425856 URL args: ()
INFO 2025-09-23 14:50:38,432 views 59085 6194425856 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:50:38,432 views 59085 6194425856 Requested invoice_id: 'INV-99099'
INFO 2025-09-23 14:50:38,432 views 59085 6194425856 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:50:38,432 views 59085 6194425856 Requested invoice_id length: 9
INFO 2025-09-23 14:50:38,446 views 59085 6194425856 Total invoices in database: 29
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-TEST-APPROVAL-002' (type: <class 'str'>, length: 21)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:50:38,447 views 59085 6194425856   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:50:38,448 views 59085 6194425856   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
WARNING 2025-09-23 14:50:38,449 views 59085 6194425856 No exact match found for invoice_id: 'INV-99099'
WARNING 2025-09-23 14:50:38,449 views 59085 6194425856 No case-insensitive match found for invoice_id: 'INV-99099'
INFO 2025-09-23 14:50:38,450 views 59085 6194425856 Found 0 invoices containing 'INV-99099':
WARNING 2025-09-23 14:50:38,451 log 59085 6194425856 Not Found: /api/v1/integration/pre-mandate-approval/INV-99099/
WARNING 2025-09-23 14:50:38,451 basehttp 59085 6194425856 "GET /api/v1/integration/pre-mandate-approval/INV-99099/ HTTP/1.1" 404 204
WARNING 2025-09-23 14:50:38,545 log 59085 6194425856 Not Found: /favicon.ico
WARNING 2025-09-23 14:50:38,545 basehttp 59085 6194425856 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 14:53:16,316 basehttp 59085 6194425856 "GET /api/v1/integration/pre-mandate-approval/INV-DEMO-999 HTTP/1.1" 301 0
INFO 2025-09-23 14:53:16,382 views 59085 6194425856 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:53:16,382 views 59085 6194425856 Request path: /api/v1/integration/pre-mandate-approval/INV-DEMO-999/
INFO 2025-09-23 14:53:16,382 views 59085 6194425856 Request method: GET
INFO 2025-09-23 14:53:16,382 views 59085 6194425856 URL kwargs: {'invoice_id': 'INV-DEMO-999'}
INFO 2025-09-23 14:53:16,382 views 59085 6194425856 URL args: ()
INFO 2025-09-23 14:53:16,383 views 59085 6194425856 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:53:16,383 views 59085 6194425856 Requested invoice_id: 'INV-DEMO-999'
INFO 2025-09-23 14:53:16,383 views 59085 6194425856 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:53:16,383 views 59085 6194425856 Requested invoice_id length: 12
INFO 2025-09-23 14:53:16,416 views 59085 6194425856 Total invoices in database: 29
INFO 2025-09-23 14:53:16,418 views 59085 6194425856   - Invoice ID: 'INV-TEST-APPROVAL-002' (type: <class 'str'>, length: 21)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,419 views 59085 6194425856   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:53:16,421 views 59085 6194425856 Found invoice with exact match: INV-DEMO-999
INFO 2025-09-23 14:53:16,422 basehttp 59085 6194425856 "GET /api/v1/integration/pre-mandate-approval/INV-DEMO-999/ HTTP/1.1" 200 10761
INFO 2025-09-23 14:57:02,435 views 59085 6194425856 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:57:02,436 views 59085 6194425856 Request path: /api/v1/integration/pre-mandate-approval/INV-DEMO-999/
INFO 2025-09-23 14:57:02,436 views 59085 6194425856 Request method: GET
INFO 2025-09-23 14:57:02,436 views 59085 6194425856 URL kwargs: {'invoice_id': 'INV-DEMO-999'}
INFO 2025-09-23 14:57:02,436 views 59085 6194425856 URL args: ()
INFO 2025-09-23 14:57:02,437 views 59085 6194425856 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:57:02,437 views 59085 6194425856 Requested invoice_id: 'INV-DEMO-999'
INFO 2025-09-23 14:57:02,437 views 59085 6194425856 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:57:02,437 views 59085 6194425856 Requested invoice_id length: 12
INFO 2025-09-23 14:57:02,456 views 59085 6194425856 Total invoices in database: 29
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-TEST-APPROVAL-002' (type: <class 'str'>, length: 21)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,460 views 59085 6194425856   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,468 views 59085 6194425856 Found invoice with exact match: INV-DEMO-999
INFO 2025-09-23 14:57:02,474 basehttp 59085 6194425856 "GET /api/v1/integration/pre-mandate-approval/INV-DEMO-999/ HTTP/1.1" 200 10761
INFO 2025-09-23 14:57:02,606 views 59085 6211252224 === URL DISPATCH DEBUG ===
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 Request path: /api/v1/integration/pre-mandate-approval/INV-DEMO-999/
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 Request method: GET
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 URL kwargs: {'invoice_id': 'INV-DEMO-999'}
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 URL args: ()
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 === PRE-MANDATE APPROVAL DEBUG ===
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 Requested invoice_id: 'INV-DEMO-999'
INFO 2025-09-23 14:57:02,607 views 59085 6211252224 Requested invoice_id type: <class 'str'>
INFO 2025-09-23 14:57:02,608 views 59085 6211252224 Requested invoice_id length: 12
INFO 2025-09-23 14:57:02,622 views 59085 6211252224 Total invoices in database: 29
INFO 2025-09-23 14:57:02,624 views 59085 6211252224   - Invoice ID: 'INV-TEST-APPROVAL-002' (type: <class 'str'>, length: 21)
INFO 2025-09-23 14:57:02,624 views 59085 6211252224   - Invoice ID: 'INV-40287' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-808' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-806' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-805' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-40257' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-40250' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-40239' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-802' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-40238' (type: <class 'str'>, length: 9)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2389' (type: <class 'str'>, length: 8)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-800' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-79999' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-780' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-INTEGRATION-TEST' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-HACKATHON-2024' (type: <class 'str'>, length: 18)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-FINAL' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-456' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-123' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-FIXED' (type: <class 'str'>, length: 14)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-DEMO-$(date +%s)' (type: <class 'str'>, length: 20)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-779' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-999' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-888' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-777' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-003' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-002' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,625 views 59085 6211252224   - Invoice ID: 'INV-2024-001' (type: <class 'str'>, length: 12)
INFO 2025-09-23 14:57:02,627 views 59085 6211252224 Found invoice with exact match: INV-DEMO-999
INFO 2025-09-23 14:57:02,628 basehttp 59085 6211252224 "GET /api/v1/integration/pre-mandate-approval/INV-DEMO-999/ HTTP/1.1" 200 10761
WARNING 2025-09-23 14:57:03,220 log 59085 6228078592 Not Found: /favicon.ico
WARNING 2025-09-23 14:57:03,220 basehttp 59085 6228078592 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 14:57:07,418 salesforce_service 59085 6211252224 Successfully updated pre_approved to True for invoice INV-DEMO-999 in Salesforce
INFO 2025-09-23 14:57:07,430 basehttp 59085 6211252224 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 200 252
INFO 2025-09-23 15:00:07,351 autoreload 59084 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:07,353 autoreload 59085 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:07,808 autoreload 66751 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:07,808 autoreload 66750 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:13,316 autoreload 66751 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 15:00:13,321 autoreload 66750 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 15:00:13,655 autoreload 66860 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:13,655 autoreload 66859 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:15,004 autoreload 66860 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:15,005 autoreload 66859 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:15,304 autoreload 66863 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:15,304 autoreload 66864 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:16,679 autoreload 66864 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 15:00:16,679 autoreload 66863 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 15:00:16,973 autoreload 66872 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:16,973 autoreload 66871 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:33,633 autoreload 66872 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:33,638 autoreload 66871 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:34,000 autoreload 67081 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:34,000 autoreload 67082 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:37,367 autoreload 67082 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:37,369 autoreload 67081 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:37,729 autoreload 67098 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:37,729 autoreload 67097 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:43,153 autoreload 67098 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:43,154 autoreload 67097 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:43,454 autoreload 67204 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:43,454 autoreload 67203 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:45,802 autoreload 67203 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:45,806 autoreload 67204 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:46,127 autoreload 67218 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:46,135 autoreload 67219 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:48,517 autoreload 67218 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/urls.py changed, reloading.
INFO 2025-09-23 15:00:48,517 autoreload 67219 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:00:48,894 autoreload 67227 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:00:48,894 autoreload 67228 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:05:12,163 views 67227 6193917952 Salesforce webhook received: {'invoice_id': 'INV-TEST-WEBHOOK-001', 'sf_invoice_id': 'SF-INV-001', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-001', 'customer_name': 'Test Customer Corp', 'mandate_id': 'MANDATE-001', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-001-2024-09-23'}
ERROR 2025-09-23 15:05:12,170 views 67227 6193917952 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-001) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-001) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-001) already exists.

ERROR 2025-09-23 15:05:12,174 log 67227 6193917952 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 15:05:12,174 basehttp 67227 6193917952 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 15:05:25,607 views 67227 6193917952 Salesforce webhook received: {'invoice_id': 'INV-TEST-WEBHOOK-002', 'sf_invoice_id': 'SF-INV-002', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-002', 'customer_name': 'Test Customer Corp', 'mandate_id': 'MANDATE-002', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-002-2024-09-23'}
ERROR 2025-09-23 15:05:25,612 views 67227 6193917952 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-002) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-002) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_external_invoice_id_key"
DETAIL:  Key (external_invoice_id)=(SF-INV-002) already exists.

ERROR 2025-09-23 15:05:25,614 log 67227 6193917952 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 15:05:25,614 basehttp 67227 6193917952 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 15:05:39,966 views 67227 6210744320 Salesforce webhook received: {'invoice_id': 'INV-TEST-1758639939', 'sf_invoice_id': 'SF-INV-1758639939', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-1758639939', 'customer_name': 'Test Customer Corp', 'mandate_id': 'MANDATE-1758639939', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-1758639939-2024-09-23'}
INFO 2025-09-23 15:05:39,979 views 67227 6210744320 Processing payment for invoice INV-TEST-1758639939 (pre_approved__c = true)
INFO 2025-09-23 15:05:39,988 a2a_ap2_integration 67227 6210744320 A2A conversation initiated: 9480ee03-ac49-4314-b0df-64eed2f8e170
INFO 2025-09-23 15:05:39,995 a2a_ap2_integration 67227 6210744320 AP2 payment initiated: ap2_eb4c8c9bb6ac4389 with status settled
INFO 2025-09-23 15:05:39,997 a2a_ap2_integration 67227 6210744320 A2A conversation 9480ee03-ac49-4314-b0df-64eed2f8e170 completed with AP2 result.
INFO 2025-09-23 15:05:39,998 basehttp 67227 6210744320 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 318
INFO 2025-09-23 15:12:02,677 autoreload 67228 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:12:02,684 autoreload 67227 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:12:03,130 autoreload 76351 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:12:03,130 autoreload 76350 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:12:30,046 autoreload 76350 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:12:30,050 autoreload 76351 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:12:30,553 autoreload 76588 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:12:30,553 autoreload 76589 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:12:33,664 views 76588 6249541632 Status update triggered A2A/AP2 processing for invoice INV-TEST-APPROVAL-002
INFO 2025-09-23 15:12:33,673 a2a_ap2_integration 76588 6249541632 A2A conversation initiated: 2b199fb6-629b-48d4-967b-769e86f840a7
INFO 2025-09-23 15:12:33,680 a2a_ap2_integration 76588 6249541632 AP2 payment initiated: ap2_8b89f19a8c9648fe with status settled
INFO 2025-09-23 15:12:33,681 a2a_ap2_integration 76588 6249541632 A2A conversation 2b199fb6-629b-48d4-967b-769e86f840a7 completed with AP2 result.
INFO 2025-09-23 15:12:33,682 basehttp 76588 6249541632 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 377
INFO 2025-09-23 15:12:45,058 views 76588 6249541632 Status update triggered A2A/AP2 processing for invoice INV-TEST-APPROVAL-002
INFO 2025-09-23 15:12:45,064 a2a_ap2_integration 76588 6249541632 A2A conversation initiated: a9a53d7b-6950-4933-83ab-75a5757a7157
INFO 2025-09-23 15:12:45,069 a2a_ap2_integration 76588 6249541632 AP2 payment initiated: ap2_7aef12d08bc942c7 with status settled
INFO 2025-09-23 15:12:45,070 a2a_ap2_integration 76588 6249541632 A2A conversation a9a53d7b-6950-4933-83ab-75a5757a7157 completed with AP2 result.
INFO 2025-09-23 15:12:45,072 basehttp 76588 6249541632 "POST /api/v1/integration/webhook/status-update/ HTTP/1.1" 200 370
INFO 2025-09-23 15:13:08,724 autoreload 76588 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:13:08,726 autoreload 76589 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 15:13:09,163 autoreload 77915 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 15:13:09,163 autoreload 77914 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:31:50,847 autoreload 12176 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:42:37,621 basehttp 12176 6127759360 "GET /api/v1/integration/pre-mandate-approval/INV-2024-79999/ HTTP/1.1" 200 10766
WARNING 2025-09-23 16:42:38,429 log 12176 6144585728 Not Found: /favicon.ico
WARNING 2025-09-23 16:42:38,429 basehttp 12176 6144585728 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 16:42:40,523 basehttp 12176 6161412096 "GET /api/v1/integration/pre-mandate-approval/INV-2024-79999/ HTTP/1.1" 200 10766
INFO 2025-09-23 16:45:14,903 basehttp 12176 6127759360 "GET /api/v1/integration/pre-mandate-approval/INV-2024-79999/ HTTP/1.1" 200 10766
INFO 2025-09-23 16:45:31,514 salesforce_service 12176 6144585728 Successfully authenticated with Salesforce
INFO 2025-09-23 16:45:33,456 salesforce_service 12176 6144585728 Successfully updated pre_approved to True for invoice INV-2024-79999 in Salesforce
INFO 2025-09-23 16:45:33,471 basehttp 12176 6144585728 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 200 254
INFO 2025-09-23 16:51:28,634 views 12176 6127759360 Salesforce webhook received: {'idempotency_key': 'SF-INV-2024-780', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-2024-780', 'invoice_id': 'INV-2024-780'}
ERROR 2025-09-23 16:51:28,652 views 12176 6127759360 Error processing Salesforce webhook: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-780) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-780) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 95, in post
    invoice = Invoice.objects.create(
        invoice_id=validated_data['invoice_id'],
    ...<10 lines>...
        status='processing'
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 677, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1067, in _save_table
    results = self._do_insert(
        cls._base_manager, using, fields, returning_fields, raw
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1108, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1845, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "invoices_invoice_id_key"
DETAIL:  Key (invoice_id)=(INV-2024-780) already exists.

ERROR 2025-09-23 16:51:28,659 log 12176 6127759360 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 16:51:28,660 basehttp 12176 6127759360 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 16:53:27,435 autoreload 77914 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:27,437 autoreload 12176 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:27,892 autoreload 22451 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:27,892 autoreload 22452 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:31,386 autoreload 22451 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:31,386 autoreload 22452 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:31,723 autoreload 22565 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:31,723 autoreload 22564 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:35,166 autoreload 22564 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:35,167 autoreload 22565 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:35,476 autoreload 22579 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:35,476 autoreload 22578 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:39,856 autoreload 22578 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:39,862 autoreload 22579 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:53:40,181 autoreload 22690 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:53:40,181 autoreload 22689 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:55:25,865 views 22690 6168997888 Salesforce webhook received: {'idempotency_key': 'SF-INV-2024-780', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-2024-780', 'invoice_id': 'INV-2024-780'}
ERROR 2025-09-23 16:55:25,886 views 22690 6168997888 Error processing Salesforce webhook: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(21) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(21) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 129, in post
    collection_request.save()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1036, in _save_table
    updated = self._do_update(
        base_qs, using, pk_val, values, update_fields, forced_update
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1101, in _do_update
    return filtered._update(values) > 0
           ~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1276, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1990, in execute_sql
    cursor = super().execute_sql(result_type)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(21) already exists.

ERROR 2025-09-23 16:55:25,892 log 22690 6168997888 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 16:55:25,893 basehttp 22690 6168997888 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 16:56:21,822 views 22690 12901707776 Salesforce webhook received: {'invoice_id': 'INV-DUP-TEST-1758646581', 'sf_invoice_id': 'SF-INV-DUP-1758646581', 'amount': 5000.0, 'currency': 'USD', 'customer_id': 'CUST-DUP-1758646581', 'customer_name': 'Duplicate Test Corp', 'mandate_id': 'MANDATE-DUP-1758646581', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-DUP-1758646581-2024-09-23'}
INFO 2025-09-23 16:56:21,832 views 22690 12901707776 Processing payment for invoice INV-DUP-TEST-1758646581 (pre_approved__c = true)
INFO 2025-09-23 16:56:21,843 a2a_ap2_integration 22690 12901707776 A2A conversation initiated: d82035ee-1e12-447d-8129-4303836dca9b
INFO 2025-09-23 16:56:21,849 a2a_ap2_integration 22690 12901707776 AP2 payment initiated: ap2_6bccde49539c420f with status settled
INFO 2025-09-23 16:56:21,850 a2a_ap2_integration 22690 12901707776 A2A conversation d82035ee-1e12-447d-8129-4303836dca9b completed with AP2 result.
INFO 2025-09-23 16:56:21,851 basehttp 22690 12901707776 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 322
INFO 2025-09-23 16:56:30,693 views 22690 12918534144 Salesforce webhook received: {'invoice_id': 'INV-DUP-TEST-1758646581', 'sf_invoice_id': 'SF-INV-DUP-1758646581-2', 'amount': 7500.0, 'currency': 'USD', 'customer_id': 'CUST-DUP-1758646581-2', 'customer_name': 'Duplicate Test Corp - Second Payment', 'mandate_id': 'MANDATE-DUP-1758646581-2', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-DUP-1758646581-2-2024-09-23'}
ERROR 2025-09-23 16:56:30,701 views 22690 12918534144 Error processing Salesforce webhook: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 129, in post
    collection_request.save()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1036, in _save_table
    updated = self._do_update(
        base_qs, using, pk_val, values, update_fields, forced_update
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1101, in _do_update
    return filtered._update(values) > 0
           ~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1276, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1990, in execute_sql
    cursor = super().execute_sql(result_type)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.

ERROR 2025-09-23 16:56:30,702 log 22690 12918534144 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 16:56:30,702 basehttp 22690 12918534144 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 16:56:55,790 autoreload 22690 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:56:55,798 autoreload 22689 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:56:56,451 autoreload 26172 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:56:56,452 autoreload 26171 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:08,137 views 26172 6192705536 Salesforce webhook received: {'invoice_id': 'INV-DUP-TEST-1758646581', 'sf_invoice_id': 'SF-INV-DUP-1758646581-3', 'amount': 3000.0, 'currency': 'USD', 'customer_id': 'CUST-DUP-1758646581-3', 'customer_name': 'Duplicate Test Corp - Third Payment', 'mandate_id': 'MANDATE-DUP-1758646581-3', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-DUP-1758646581-3-2024-09-23'}
ERROR 2025-09-23 16:57:08,153 views 26172 6192705536 Error processing Salesforce webhook: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.
Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py", line 138, in post
    collection_request.save()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 822, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 909, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1036, in _save_table
    updated = self._do_update(
        base_qs, using, pk_val, values, update_fields, forced_update
    )
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/base.py", line 1101, in _do_update
    return filtered._update(values) > 0
           ~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/query.py", line 1276, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1990, in execute_sql
    cursor = super().execute_sql(result_type)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/models/sql/compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/divyanshubhati/Desktop/collections-agent-backend/venv/lib/python3.13/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
django.db.utils.IntegrityError: duplicate key value violates unique constraint "collection_requests_invoice_id_key"
DETAIL:  Key (invoice_id)=(43) already exists.

ERROR 2025-09-23 16:57:08,160 log 26172 6192705536 Internal Server Error: /api/v1/integration/salesforce/webhook/
ERROR 2025-09-23 16:57:08,161 basehttp 26172 6192705536 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 500 121
INFO 2025-09-23 16:57:25,471 autoreload 26171 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:25,495 autoreload 26172 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:25,894 autoreload 27312 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:25,895 autoreload 27311 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:33,451 autoreload 27311 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:33,457 autoreload 27312 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:33,851 autoreload 27431 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:33,852 autoreload 27430 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:38,266 autoreload 27430 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:38,266 autoreload 27431 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:57:38,577 autoreload 27453 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:57:38,577 autoreload 27454 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:58:15,725 views 27453 6205566976 Salesforce webhook received: {'invoice_id': 'INV-DUP-TEST-1758646581', 'sf_invoice_id': 'SF-INV-DUP-1758646581-4', 'amount': 2000.0, 'currency': 'USD', 'customer_id': 'CUST-DUP-1758646581-4', 'customer_name': 'Duplicate Test Corp - Fourth Payment', 'mandate_id': 'MANDATE-DUP-1758646581-4', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-DUP-1758646581-4-2024-09-23'}
INFO 2025-09-23 16:58:15,739 views 27453 6205566976 Processing payment for invoice INV-DUP-TEST-1758646581 (pre_approved__c = true)
INFO 2025-09-23 16:58:15,748 a2a_ap2_integration 27453 6205566976 A2A conversation initiated: 55ba6ba1-c19c-4eeb-a387-4bf0da5d3515
INFO 2025-09-23 16:58:15,756 a2a_ap2_integration 27453 6205566976 AP2 payment initiated: ap2_f08ea995b2e54fa8 with status settled
INFO 2025-09-23 16:58:15,757 a2a_ap2_integration 27453 6205566976 A2A conversation 55ba6ba1-c19c-4eeb-a387-4bf0da5d3515 completed with AP2 result.
INFO 2025-09-23 16:58:15,758 basehttp 27453 6205566976 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 322
INFO 2025-09-23 16:58:23,713 views 27453 6205566976 Salesforce webhook received: {'invoice_id': 'INV-DUP-TEST-1758646581', 'sf_invoice_id': 'SF-INV-DUP-1758646581-5', 'amount': 1000.0, 'currency': 'USD', 'customer_id': 'CUST-DUP-1758646581-5', 'customer_name': 'Duplicate Test Corp - Fifth Payment', 'mandate_id': 'MANDATE-DUP-1758646581-5', 'payment_method': 'ACH', 'due_date': '2024-09-15T00:00:00Z', 'approved_by': 'salesforce@company.com', 'idempotency_key': 'SF-INV-DUP-1758646581-5-2024-09-23'}
INFO 2025-09-23 16:58:23,723 views 27453 6205566976 Processing payment for invoice INV-DUP-TEST-1758646581 (pre_approved__c = true)
INFO 2025-09-23 16:58:23,730 a2a_ap2_integration 27453 6205566976 A2A conversation initiated: f555c8cd-d819-4a13-b8b5-9ffbcfdf9d8e
INFO 2025-09-23 16:58:23,734 a2a_ap2_integration 27453 6205566976 AP2 payment initiated: ap2_a459cf43a8864942 with status settled
INFO 2025-09-23 16:58:23,735 a2a_ap2_integration 27453 6205566976 A2A conversation f555c8cd-d819-4a13-b8b5-9ffbcfdf9d8e completed with AP2 result.
INFO 2025-09-23 16:58:23,736 basehttp 27453 6205566976 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 322
INFO 2025-09-23 16:58:27,307 autoreload 27453 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:58:27,686 autoreload 29411 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:58:28,050 autoreload 27454 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:58:28,331 autoreload 29413 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:58:40,331 autoreload 29411 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:58:40,651 autoreload 29673 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 16:58:40,859 autoreload 29413 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-23 16:58:41,137 autoreload 29675 8299364928 Watching for file changes with StatReloader
INFO 2025-09-23 17:04:41,822 basehttp 29673 6129102848 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10760
WARNING 2025-09-23 17:04:42,557 log 29673 6145929216 Not Found: /favicon.ico
WARNING 2025-09-23 17:04:42,558 basehttp 29673 6145929216 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 17:04:57,619 basehttp 29673 6162755584 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10760
INFO 2025-09-23 17:05:24,580 salesforce_service 29673 6179581952 Successfully authenticated with Salesforce
INFO 2025-09-23 17:05:26,444 salesforce_service 29673 6179581952 Successfully updated pre_approved to True for invoice INV-2024-780 in Salesforce
INFO 2025-09-23 17:05:26,455 basehttp 29673 6179581952 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 200 252
INFO 2025-09-23 17:08:20,539 views 29673 6129102848 Salesforce webhook received: {'idempotency_key': 'SF-INV-2024-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-2024-79999', 'invoice_id': 'INV-2024-79999'}
INFO 2025-09-23 17:08:20,592 views 29673 6129102848 Processing payment for invoice INV-2024-79999 (pre_approved__c = true)
INFO 2025-09-23 17:08:20,604 a2a_ap2_integration 29673 6129102848 A2A conversation initiated: fcfe9abd-6dea-4a43-a892-907fe5c5c78c
INFO 2025-09-23 17:08:20,611 a2a_ap2_integration 29673 6129102848 AP2 payment initiated: ap2_29a6d997ffd14b98 with status settled
INFO 2025-09-23 17:08:20,612 a2a_ap2_integration 29673 6129102848 A2A conversation fcfe9abd-6dea-4a43-a892-907fe5c5c78c completed with AP2 result.
INFO 2025-09-23 17:08:20,614 basehttp 29673 6129102848 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 200 313
INFO 2025-09-23 17:13:20,820 basehttp 29673 6145929216 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10771
INFO 2025-09-23 17:40:51,948 basehttp 29673 6145929216 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10771
WARNING 2025-09-23 17:40:52,596 log 29673 6162755584 Not Found: /favicon.ico
WARNING 2025-09-23 17:40:52,596 basehttp 29673 6162755584 "GET /favicon.ico HTTP/1.1" 404 3050
INFO 2025-09-23 17:41:41,822 basehttp 29673 6179581952 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10771
INFO 2025-09-23 17:41:52,130 salesforce_service 29673 6129102848 Successfully updated pre_approved to True for invoice INV-2024-780 in Salesforce
INFO 2025-09-23 17:41:52,146 basehttp 29673 6129102848 "POST /api/v1/integration/pre-mandate-decision/ HTTP/1.1" 200 252
INFO 2025-09-23 17:45:30,573 views 29673 6145929216 Salesforce webhook received: {'idempotency_key': 'SF-INV-2024-79999', 'approved_by': 'salesforce@company.com', 'due_date': '2024-09-15T00:00:00Z', 'payment_method': 'ACH', 'mandate_id': 'MANDATE-777', 'customer_name': 'Edge Communications', 'customer_id': 'CUST-777', 'currency': 'USD', 'amount': 7500.0, 'sf_invoice_id': 'SF-INV-2024-79999', 'invoice_id': 'INV-2024-79999'}
INFO 2025-09-23 17:45:30,761 basehttp 29673 6145929216 "POST /api/v1/integration/salesforce/webhook/ HTTP/1.1" 202 105
INFO 2025-09-24 04:50:07,651 basehttp 29673 6162755584 "GET /api/v1/integration/pre-mandate-approval/INV-2024-780/ HTTP/1.1" 200 10771
INFO 2025-09-24 05:52:51,355 autoreload 29675 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-24 05:52:51,805 autoreload 92628 8299364928 Watching for file changes with StatReloader
INFO 2025-09-24 05:53:07,647 autoreload 92628 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-24 05:53:07,917 autoreload 92750 8299364928 Watching for file changes with StatReloader
INFO 2025-09-24 05:55:54,053 autoreload 92750 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-24 05:55:54,387 autoreload 94721 8299364928 Watching for file changes with StatReloader
INFO 2025-09-24 05:55:59,864 autoreload 94721 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/integration/views.py changed, reloading.
INFO 2025-09-24 05:56:00,063 autoreload 94738 8299364928 Watching for file changes with StatReloader
INFO 2025-09-24 05:56:46,321 basehttp 94738 6128316416 "GET /api/v1/integration/pre-mandate-approval/INV-TEST-APPROVAL-002/ HTTP/1.1" 200 10840
INFO 2025-09-24 05:56:55,540 autoreload 94738 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
INFO 2025-09-24 05:56:55,860 autoreload 95631 8299364928 Watching for file changes with StatReloader
INFO 2025-09-24 07:13:18,476 autoreload 95631 8299364928 /Users/divyanshubhati/Desktop/collections-agent-backend/collections_agent/settings.py changed, reloading.
